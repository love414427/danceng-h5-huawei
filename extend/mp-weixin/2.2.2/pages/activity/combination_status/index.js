(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/activity/combination_status/index"],{1832:function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){}));var s=function(){var t=this,e=t.$createElement,i=(t._self._c,t.pinkAll.length);t._isMounted||(t.e0=function(e){t.H5ShareBox=!1}),t.$mp.data=Object.assign({},{$root:{g0:i}})},o=[]},"3db1":function(t,e,i){"use strict";var s=i("7d3e"),o=i.n(s);o.a},"642e":function(t,e,i){"use strict";i.r(e);var s=i("1832"),o=i("6482");for(var n in o)["default"].indexOf(n)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(n);i("3db1");var r=i("f0c5"),a=Object(r["a"])(o["default"],s["b"],s["c"],!1,null,"457d3592",null,!1,s["a"],void 0);e["default"]=a.exports},6482:function(t,e,i){"use strict";i.r(e);var s=i("84f7"),o=i.n(s);for(var n in s)["default"].indexOf(n)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(n);e["default"]=o.a},"7d3e":function(t,e,i){},"84f7":function(t,e,i){"use strict";(function(t){var s=i("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=s(i("2eee")),n=s(i("c973")),r=i("26cb"),a=i("041f"),c=i("736f"),u=i("ddb3"),h=getApp(),d={name:"GroupRule",components:{CountDown:function(){i.e("components/countDown/index").then(function(){return resolve(i("628d"))}.bind(null,i)).catch(i.oe)},ProductWindow:function(){i.e("components/productWindow/index").then(function(){return resolve(i("b739"))}.bind(null,i)).catch(i.oe)},home:function(){i.e("components/home/index").then(function(){return resolve(i("4cc1"))}.bind(null,i)).catch(i.oe)},canvasPoster:function(){i.e("pages/activity/combination_poster/index").then(function(){return resolve(i("8036"))}.bind(null,i)).catch(i.oe)},copyPassword:function(){i.e("components/copyPassword/index").then(function(){return resolve(i("5f00"))}.bind(null,i)).catch(i.oe)}},props:{},data:function(){return{currentPinkOrder:"",isOk:0,pinkBool:0,userBool:0,pinkAll:[],storeCombination:[],storeCombinationHost:[],pinkId:0,count:0,iShidden:!1,isOpen:!1,attr:{cartAttr:!1,productSelect:{image:"",store_name:"",price:"",quota:0,unique:"",cart_num:1,quota_show:0,product_stock:0,num:0},productAttr:[]},cart_num:"",userInfo:{},combinationData:{},posters:!1,weixinStatus:!1,H5ShareBox:!1,attrTxt:"请选择",attrValue:"",posterStatus:!1,posterCompenents:!1,currSpid:"",picData:{bagPic:"",goodsPic:"",codePic:"",title:"",label:"",msg:"",price:""},isCopy:!1,copyUrl:"",justifyLeft:""}},computed:(0,r.mapGetters)(["isLogin","uid","viewColor"]),watch:{isLogin:{handler:function(t,e){t&&this.getCombinationPink()},deep:!0}},onLoad:function(t){if(this.justifyLeft=this.viewColor,t.id&&(this.pinkId=t.id),t.scene){var e=this.$util.getUrlParams(decodeURIComponent(t.scene));e.id&&(this.pinkId=e.id),e.spid&&(h.globalData.spid=e.spid,this.currSpid=e.spid)}0==this.isLogin?(0,u.toLogin)():this.getCombinationPink()},mounted:function(){this.getCombinationProductList(),this.getPosterCode()},onShareAppMessage:function(){var t="/pages/activity/combination_status/index?id="+this.pinkId;return{title:"您的好友"+this.pinkAll[0].nickname+"邀请您参团"+this.storeCombination.store_name,path:t,imageUrl:this.storeCombination.image||""}},onShareTimeline:function(){return{title:"您的好友"+this.pinkAll[0].nickname+"邀请您参团"+this.storeCombination.store_name,query:{id:this.pinkId,spid:this.uid},imageUrl:this.storeCombination.image||""}},methods:{listenerActionSheet:function(){0==this.isLogin?(0,u.toLogin)():this.posters=!this.posters},listenerActionClose:function(){this.posters=!1},goFriend:function(){this.posters=!1},iptCartNum:function(t){this.$set(this.attr.productSelect,"cart_num",t),this.$set(this,"cart_num",t)},attrVal:function(t){this.attr.productAttr[t.indexw].index=this.attr.productAttr[t.indexw].attr_values[t.indexn]},onMyEvent:function(){this.$set(this.attr,"cartAttr",!1),this.$set(this,"isOpen",!1)},ChangeAttr:function(t){this.$set(this,"cart_num",1);var e=this.productValue[t];e?(this.$set(this.attr.productSelect,"image",e.image),this.$set(this.attr.productSelect,"price",e.price),this.$set(this.attr.productSelect,"stock",e.stock),this.$set(this.attr.productSelect,"quota",e.quota),this.$set(this.attr.productSelect,"unique",e.unique),this.$set(this.attr.productSelect,"cart_num",1),this.$set(this.attr.productSelect,"product_stock",e.stock),this.$set(this.attr.productSelect,"quota_show",e.stock),this.$set(this,"attrValue",t),this.$set(this,"attrTxt","已选择")):(this.$set(this.attr.productSelect,"image",this.storeCombination.image),this.$set(this.attr.productSelect,"price",this.storeCombination.price),this.$set(this.attr.productSelect,"quota",0),this.$set(this.attr.productSelect,"unique",""),this.$set(this.attr.productSelect,"cart_num",0),this.$set(this.attr.productSelect,"quota_show",0),this.$set(this.attr.productSelect,"stock",0),this.$set(this.attr.productSelect,"product_stock",0),this.$set(this,"attrValue",""),this.$set(this,"attrTxt","请选择"))},ChangeCartNum:function(t){var e=this.productValue[this.attrValue];if(void 0!==e||this.attr.productAttr.length||(e=this.attr.productSelect),void 0!==e){var i=e.stock||0,s=this.attr.productSelect;t?(s.cart_num++,s.cart_num>i&&(this.$set(this.attr.productSelect,"cart_num",i),this.$set(this,"cart_num",i))):(s.cart_num--,s.cart_num<1&&(this.$set(this.attr.productSelect,"cart_num",1),this.$set(this,"cart_num",1)))}},DefaultSelect:function(){var t=this.attr.productAttr,e=[];for(var i in this.productValue)if(this.productValue[i].stock>0){e=this.attr.productAttr.length?i.split(","):[];break}for(var s=0;s<t.length;s++)this.$set(t[s],"index",e[s]);var o=this.productValue[e.join(",")];o&&t.length?(this.$set(this.attr.productSelect,"store_name",this.storeCombination.store_name),this.$set(this.attr.productSelect,"image",o.image),this.$set(this.attr.productSelect,"price",o.price),this.$set(this.attr.productSelect,"stock",o.stock),this.$set(this.attr.productSelect,"unique",o.unique),this.$set(this.attr.productSelect,"cart_num",1),this.$set(this.attr.productSelect,"product_stock",o.stock),this.$set(this.attr.productSelect,"quota_show",o.stock),this.$set(this,"attrValue",e.join(",")),this.attrValue=e.join(","),this.$set(this,"attrTxt","已选择")):!o&&t.length?(this.$set(this.attr.productSelect,"store_name",this.storeCombination.store_name),this.$set(this.attr.productSelect,"image",this.storeCombination.image),this.$set(this.attr.productSelect,"price",this.storeCombination.price),this.$set(this.attr.productSelect,"stock",0),this.$set(this.attr.productSelect,"unique",""),this.$set(this.attr.productSelect,"cart_num",0),this.$set(this.attr.productSelect,"product_stock",0),this.$set(this.attr.productSelect,"quota_show",0),this.$set(this,"attrValue",""),this.$set(this,"attrTxt","请选择")):o||t.length?o&&!t.length&&(this.$set(this.attr.productSelect,"store_name",this.storeCombination.store_name),this.$set(this.attr.productSelect,"image",o.image),this.$set(this.attr.productSelect,"price",o.price),this.$set(this.attr.productSelect,"stock",o.stock),this.$set(this.attr.productSelect,"unique",o.unique),this.$set(this.attr.productSelect,"quota_show",o.stock),this.$set(this,"attrValue",e.join(",")),this.$set(this,"attrTxt","已选择"),0==o.stock?this.$set(this.attr.productSelect,"cart_num",0):this.$set(this.attr.productSelect,"cart_num",1)):(this.$set(this.attr.productSelect,"store_name",this.storeCombination.store_name),this.$set(this.attr.productSelect,"image",this.storeCombination.image),this.$set(this.attr.productSelect,"price",this.storeCombination.price),this.$set(this.attr.productSelect,"stock",0),this.$set(this.attr.productSelect,"unique",this.storeCombination.unique||""),this.$set(this.attr.productSelect,"cart_num",1),this.$set(this.attr.productSelect,"quota_show",0),this.$set(this.attr.productSelect,"product_stock",0),this.$set(this,"attrValue",""),this.$set(this,"attrTxt","请选择"))},setProductSelect:function(){var t=this.attr;t.productSelect.image=this.storeCombination.image,t.productSelect.store_name=this.storeCombination.store_name,t.productSelect.price=this.storeCombination.price,t.productSelect.quota=0,t.productSelect.quota_show=this.storeCombination.stock,t.productSelect.stock=this.storeCombination.stock,t.productSelect.product_stock=this.storeCombination.stock,t.cartAttr=!1,this.$set(this,"attr",t)},pay:function(){this.attr.cartAttr=!0,this.isOpen=!0},goPay:function(){var e=this,i={product_id:e.combinationData.product_group_id,product_attr_unique:void 0!==e.attr.productSelect?e.attr.productSelect.unique:"",cart_num:e.attr.productSelect.cart_num,product_type:4,is_new:1,group_buying_id:e.combinationData.group_buying_id};(0,c.postCartAdd)(i).then((function(e){t.navigateTo({url:"/pages/users/order_confirm/index?new=1&cartId="+e.data.cart_id})})).catch((function(t){e.$util.Tips({title:t})}))},goPoster:function(){this.posters=!1,this.posterStatus=!0},goOrder:function(){t.navigateTo({url:"/pages/order_details/index?order_id="+this.currentPinkOrder})},goList:function(){t.navigateTo({url:"/pages/activity/combination/index"})},goDetail:function(e){this.pinkId=e,t.navigateTo({url:"/pages/activity/combination_details/index?id="+e})},getPosterCode:function(){var t=this;(0,c.getProductCode)(this.pinkId,{type:"routine",product_type:40}).then((function(e){t.picData.codePic=e.data.url})).catch((function(e){t.$util.Tips({title:e})}))},copyPwd:function(){var t=this;(0,c.copyPasswordApi)({id:t.pinkId,product_type:40}).then(function(){var e=(0,n.default)(o.default.mark((function e(i){return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.copyUrl=i.data.str,t.posters=!1,t.isCopy=!0;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},closeCopy:function(){this.isCopy=!1},getCombinationPink:function(){var e=this,i=this;t.showLoading({title:"加载中",mask:!0}),(0,a.getCombinationPink)(i.pinkId).then((function(s){t.hideLoading(),i.$set(i,"combinationData",s.data),i.$set(i,"storeCombination",s.data.product),i.$set(i,"pinkAll",s.data.groupUser),i.$set(i,"count",s.data.buying_count_num-s.data.yet_buying_num),i.$set(i,"userBool",s.data.create_status),i.$set(i,"pinkBool",s.data.status),i.$set(i,"currentPinkOrder",s.data.self?s.data.self.order_id:""),i.attr.productAttr=s.data.product.attr,i.productValue=s.data.product.sku,i.$set(i.picData,"goodsPic",s.data.product.image),i.$set(i.picData,"title",s.data.product.store_name.length>28?s.data.product.store_name.slice(0,28)+"...":s.data.product.store_name),i.$set(i.picData,"label",s.data.buying_count_num+"人团"),i.$set(i.picData,"price",s.data.product.price),i.$set(i.picData,"msg","市场价：¥ "+s.data.product.ot_price+" 还差 "+i.count+" 人 拼团成功"),e.posterCompenents=!0,i.setProductSelect(),i.DefaultSelect()})).catch((function(i){e.$util.Tips({title:i}),t.redirectTo({success:function(){},fail:function(){t.navigateTo({url:"/pages/index/index"})}})}))},getCombinationProductList:function(){var t=this;(0,a.getCombinationList)({page:1}).then((function(e){var i=e.data.list;t.storeCombinationHost=t.storeCombinationHost.concat(i)})).catch((function(e){t.$util.Tips({title:e})}))},getCombinationRemove:function(){var e=this;t.showModal({title:"提示",content:"确定取消拼团？",success:function(t){if(t.confirm)(0,a.postCombinationRemove)({group_buying_id:e.pinkId}).then((function(t){e.$util.Tips({title:t.message},{tab:3})})).catch((function(t){e.$util.Tips({title:t.message})}));else if(t.cancel)return e.$util.Tips({title:"已取消"})}})},lookAll:function(){this.iShidden=!this.iShidden}}};e.default=d}).call(this,i("543d")["default"])},"949c":function(t,e,i){"use strict";(function(t,e){var s=i("4ea4");i("4c7d");s(i("66fd"));var o=s(i("642e"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(o.default)}).call(this,i("bc2e")["default"],i("543d")["createPage"])}},[["949c","common/runtime","common/vendor"]]]);