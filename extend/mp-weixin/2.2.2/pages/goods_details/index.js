(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/goods_details/index"],{"1cff":function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return n}));var n={easyLoadimage:function(){return Promise.all([i.e("common/vendor"),i.e("components/easy-loadimage/easy-loadimage")]).then(i.bind(null,"2243"))},jyfParser:function(){return Promise.all([i.e("common/vendor"),i.e("components/jyf-parser/jyf-parser")]).then(i.bind(null,"3192"))}},o=function(){var t=this,e=t.$createElement,i=(t._self._c,t.storeInfo&&t.storeInfo.merchant?t.coupon.list.length||t.storeInfo.top_pid:null),n=t.storeInfo&&t.storeInfo.merchant?t.coupon.list.length:null,o=t.storeInfo&&t.storeInfo.merchant?t.specsInfo.params&&t.specsInfo.params.length>0:null,s=t.storeInfo&&t.storeInfo.merchant?t.guarantee&&t.guarantee.length:null,r=t.storeInfo&&t.storeInfo.merchant?t.comboList&&t.comboList.length>0:null,a=t.storeInfo&&t.storeInfo.merchant?t.storeInfo.community&&t.storeInfo.community.length>0:null,c=t.storeInfo&&t.storeInfo.merchant&&t.storeInfo.merchant&&1!=t.hide_mer_status&&1!=t.hide_mer_status&&t.storeInfo.merchant.care_count&&!(t.storeInfo.merchant.care_count<1e4)?(t.storeInfo.merchant.care_count/1e4).toFixed(2):null,u=t.storeInfo&&t.storeInfo.merchant&&t.storeInfo.merchant&&1!=t.hide_mer_status?t.storeInfo.merchant.recommend&&t.storeInfo.merchant.recommend.length>0:null,h=t.storeInfo&&t.storeInfo.merchant&&t.description&&0==t.description.type?t.description.content.replace(/<br\/>/gi,""):null,l=t.storeInfo&&t.storeInfo.merchant&&t.priceRule.content?t.priceRule.content.replace(/<br\/>/gi,""):null;t._isMounted||(t.e0=function(e){t.H5ShareBox=!1}),t.$mp.data=Object.assign({},{$root:{g0:i,g1:n,g2:o,g3:s,g4:r,g5:a,g6:c,g7:u,g8:h,g9:l}})},s=[]},"5c6b":function(t,e,i){"use strict";i.r(e);var n=i("1cff"),o=i("e8a8");for(var s in o)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(s);i("6e68");var r=i("f0c5"),a=Object(r["a"])(o["default"],n["b"],n["c"],!1,null,"50fde07f",null,!1,n["a"],void 0);e["default"]=a.exports},"6e68":function(t,e,i){"use strict";var n=i("9dba"),o=i.n(n);o.a},"9dba":function(t,e,i){},a5e9:function(t,e,i){"use strict";(function(t,e){var n=i("4ea4");i("4c7d");n(i("66fd"));var o=n(i("5c6b"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(o.default)}).call(this,i("bc2e")["default"],i("543d")["createPage"])},c2f0:function(t,e,i){"use strict";(function(t){var n=i("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o,s=n(i("2eee")),r=n(i("c973")),a=n(i("9523")),c=i("4d59"),u=i("736f"),h=i("59c6"),l=i("6859"),d=i("58d4"),p=i("26cb"),f=i("3255"),m=(i("cd6d"),i("ddb3")),g=i("f26a"),_=n(i("c5df")),v=n(i("9673"));n(i("43a2"));function $(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}var I=t.getSystemInfoSync().statusBarHeight,S=getApp(),y={components:{passwordPopup:function(){Promise.all([i.e("common/vendor"),i.e("components/passwordPopup/index")]).then(function(){return resolve(i("5edd"))}.bind(null,i)).catch(i.oe)},productConSwiper:function(){i.e("components/productConSwiper/index").then(function(){return resolve(i("58c8"))}.bind(null,i)).catch(i.oe)},couponListWindow:function(){i.e("components/couponListWindow/index").then(function(){return resolve(i("5fac"))}.bind(null,i)).catch(i.oe)},productWindow:function(){i.e("components/productWindow/index").then(function(){return resolve(i("b739"))}.bind(null,i)).catch(i.oe)},userEvaluation:function(){i.e("components/userEvaluation/index").then(function(){return resolve(i("35a8"))}.bind(null,i)).catch(i.oe)},shareRedPackets:function(){i.e("components/shareRedPackets/index").then(function(){return resolve(i("fb7b"))}.bind(null,i)).catch(i.oe)},home:function(){i.e("components/home/index").then(function(){return resolve(i("4cc1"))}.bind(null,i)).catch(i.oe)},guaranteeTemplate:function(){i.e("components/freightGuarantee/index").then(function(){return resolve(i("8f11"))}.bind(null,i)).catch(i.oe)},copyPassword:function(){i.e("components/copyPassword/index").then(function(){return resolve(i("5f00"))}.bind(null,i)).catch(i.oe)},discountsGoods:function(){Promise.all([i.e("common/vendor"),i.e("pages/goods_details/discountsGoods")]).then(function(){return resolve(i("ced3"))}.bind(null,i)).catch(i.oe)},"jyf-parser":function(){Promise.all([i.e("common/vendor"),i.e("components/jyf-parser/jyf-parser")]).then(function(){return resolve(i("3192"))}.bind(null,i)).catch(i.oe)},easyLoadimage:function(){Promise.all([i.e("common/vendor"),i.e("components/easy-loadimage/easy-loadimage")]).then(function(){return resolve(i("2243"))}.bind(null,i)).catch(i.oe)},specs:function(){i.e("components/specs/index").then(function(){return resolve(i("ecaf"))}.bind(null,i)).catch(i.oe)}},mixins:[_.default],data:function(){return{isNodes:0,sysHeight:I,coupon:{coupon:!1,list:[]},attrTxt:"选择",attrValue:"",animated:!1,id:0,replyCount:0,reply:[],storeInfo:{merchant:{}},productValue:[],couponList:[],cart_num:1,isOpen:!1,actionSheetHidden:!0,posterImageStatus:!1,storeImage:"",PromotionCode:"",canvasStatus:!1,posterImage:"",posterbackgd:"/static/images/posterbackgd.png",source:"",sharePacket:{isState:!0},circular:!1,autoplay:!1,interval:3e3,duration:500,clientHeight:"",systemStore:{},replyChance:0,CartCount:0,isDown:!0,storeSelfMention:!0,posters:!1,weixinStatus:!1,attr:{cartAttr:!1,productAttr:[],productSelect:{}},description:"",navActive:0,H5ShareBox:!1,activity:[],retunTop:!0,navH:"",navList:[],opacity:0,scrollY:0,topArr:[],toView:"",height:0,heightArr:[],lock:!1,scrollTop:0,tagStyle:{img:"width:100%;display:block;"},showAnimate:!0,domain:g.HTTP_REQUEST_URL,currSpid:"",codeImg:"",videoCoverImg:"",shipping:"",guarantee:[],shippingValue:"",uniqueValue:"",priceRule:"",isCopy:!1,copyUrl:"",comboTotal:0,comboList:[],max_count:0,min_count:0,pay_limit:1,svipData:{},svipPrice:!1,specsInfo:{show:!1,params:[]},serviceInfo:{},currentPage:!1,homeTop:59,selectNavList:[{name:"首页",icon:"icon-shouye8",url:"/pages/index/index",after:"dialog_after"},{name:"搜索",icon:"icon-sousuo6",url:"/pages/columnGoods/goods_search_con/index",after:"dialog_after"},{name:"购物车",icon:"icon-gouwuche7",url:"/pages/order_addcart/order_addcart",after:"dialog_after"},{name:"我的收藏",icon:"icon-shoucang3",url:"/pages/users/user_goods_collection/index",after:"dialog_after"},{name:"个人中心",icon:"icon-gerenzhongxin1",url:"/pages/user/index"}]}},computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?$(Object(i),!0).forEach((function(e){(0,a.default)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):$(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},(0,f.configMap)(["margin_ico_switch","margin_ico","hide_mer_status","procudt_increase_status","site_name","share_pic"],(0,p.mapGetters)(["isLogin","uid","viewColor"]))),onLoad:function(e){var i=this;e.spid&&(S.globalData.spid=e.spid,i.currSpid=e.spid);var n=getCurrentPages(),o=n[n.length-1];n.length<=1&&(i.retunTop=!1);var s=o.options||o.$route.query;if(i.source=s.source,i.navH=S.globalData.navHeight+10,i.id=e.id,t.getSystemInfo({success:function(t){i.height=t.windowHeight,i.navHeight=t.statusBarHeight*(750/t.windowWidth)+91}}),e.scene){var r=this.$util.getUrlParams(decodeURIComponent(e.scene));r.id&&(e.id=r.id),r.spid&&(S.globalData.spid=r.spid,i.currSpid=r.spid)}if(!e.id&&!e.scene)return this.$util.Tips({title:"缺少参数无法查看商品"},{tab:3,url:1});this.id=e.id,e.spid&&(S.globalData.spid=e.spid),(0,v.default)(i.currSpid,i.isLogin),this.getGoodsDetails(),this.getDiscountsData(),this.isLogin&&(this.downloadFilePromotionCode(),this.getHistory())},onReady:function(){this.isNodes++,this.$nextTick((function(){var e=this,i=t.getMenuButtonBoundingClientRect(),n=t.createSelectorQuery().in(this);n.select("#home").boundingClientRect((function(t){e.homeTop=2*i.top+i.height-t.height})).exec()}))},onShow:function(){t.hideLoading()},onShareAppMessage:function(){return this.$set(this,"actionSheetHidden",!this.actionSheetHidden),{title:this.storeInfo.store_name||"",imageUrl:this.storeInfo.image||"",path:"/pages/goods_details/index?id="+this.id+"&spid="+this.uid}},onShareTimeline:function(){return this.$set(this,"actionSheetHidden",!this.actionSheetHidden),{title:this.storeInfo.store_name||"",query:{id:this.id,spid:this.uid},imageUrl:this.storeInfo.image||""}},methods:(o={call:function(){var e=this;if(!e.storeInfo.merchant.service_phone)return e.$util.Tips({title:"暂无可用客服"});t.showModal({title:"提示",content:"暂无在线客服，确定拨打客服电话:"+e.storeInfo.merchant.service_phone+"吗？",success:function(i){i.confirm&&t.makePhoneCall({phoneNumber:e.storeInfo.merchant.service_phone,success:function(t){},fail:function(t){}})}})},getConfig:function(){getconfig().then((function(t){})).catch((function(t){}))},arrivalNotice:function(){var t=this;(0,c.arrivalSubscribe)().then((function(e){t.arrivalNoticeFun()})).catch((function(t){}))},arrivalNoticeFun:function(){var t=this,e=t.uniqueValue;(0,u.arrivalNoticeApi)({unique:e,type:3,product_id:t.id}).then((function(e){return t.$util.Tips({title:e.message})})).catch((function(e){return t.$util.Tips({title:e})}))},goProDetail:function(e){t.redirectTo({url:"/pages/goods_details/index?id="+e.product_id})},linkPage:function(e){["/pages/index/index","/pages/order_addcart/order_addcart","/pages/user/index","/pages/plant_grass/index"].indexOf(e)>-1?t.switchTab({url:e}):t.navigateTo({url:e}),this.currentPage=!1},boxStatus:function(t){this.showAnimate=t},closeChange:function(){this.$set(this.sharePacket,"isState",!0)},showNav:function(){this.currentPage=!this.currentPage},hideNav:function(){this.currentPage=!1},showShip:function(){this.$refs.guartemplate.showShippingTel()},showGuaranee:function(){this.$refs.guartemplate.showGuaranteeTel()},openCombo:function(){this.$refs.discounts.showPopup(this.id)},seeSpecs:function(){this.specsInfo.show=!0},mySpecs:function(){this.$set(this.specsInfo,"show",!1)},getDiscountsData:function(){var t=this;(0,u.getDiscountsLst)({product_id:this.id}).then((function(e){t.comboTotal=e.data.count,e.data.list.forEach((function(t,e){t.save_price=0,t.discountsProduct.forEach((function(e,i){t.save_price+=parseFloat(e.product.ot_price)-parseFloat(e.product.price)}))})),t.comboList=e.data.list})).catch((function(t){}))},getPricrRule:function(){var t=this;(0,u.priceRuleApi)(this.storeInfo.cate_id).then((function(e){t.priceRule=e.data})).catch((function(t){}))},goActivity:function(e){var i=e;"1"===i.type?t.navigateTo({url:"/pages/activity/goods_seckill_details/index?id=".concat(i.id,"&time=").concat(i.time,"&status=1")}):"2"===i.type?t.navigateTo({url:"/pages/activity/goods_bargain_details/index?id=".concat(i.id,"&bargain=").concat(this.uid)}):t.navigateTo({url:"/pages/activity/goods_combination_details/index?id=".concat(i.id)})},iptCartNum:function(t){this.$set(this.attr.productSelect,"cart_num",t)},returns:function(){t.navigateBack()},goHome:function(){t.switchTab({url:"/pages/index/index"})},goPlant:function(e){1==e.is_type?t.navigateTo({url:"/pages/plantGrass/plant_detail/index?id="+e.community_id}):t.navigateTo({url:"/pages/short_video/nvueSwiper/index?id="+e.community_id+"&tab=1"})},tap:function(t){var e="past"+t;t=t;this.$set(this,"toView",e),this.$set(this,"navActive",t),this.$set(this,"lock",!0),this.$set(this,"scrollTop",t>0?this.topArr[t]-S.globalData.navHeight/2:this.topArr[t])},scroll:function(e){var i=e.detail.scrollTop,n=i/200;if(n=n>1?1:n,this.$set(this,"showAnimate",!1),this.$set(this,"opacity",n),this.$set(this,"scrollY",i),this.lock)this.$set(this,"lock",!1);else{for(var o=0;o<this.topArr.length;o++)if(i<this.topArr[o]-S.globalData.navHeight/2+this.heightArr[o]){this.$set(this,"navActive",o);break}t.$emit("scroll")}},ChangCouponsClone:function(){this.$set(this.coupon,"coupon",!1)},ChangeCartNum:function(t){var e=this.productValue[this.attrValue];if(void 0!==e||this.attr.productAttr.length||(e=this.attr.productSelect),void 0!==e){var i=e.stock||0,n=this.attr.productSelect;if(t){if(n.cart_num++,n.cart_num>i&&(this.$set(this.attr.productSelect,"cart_num",i),this.$set(this,"cart_num",i)),n.cart_num>this.storeInfo.once_max_count&&0!=this.storeInfo.once_max_count&&0!=this.storeInfo.pay_limit)return this.$set(this.attr.productSelect,"cart_num",this.storeInfo.once_max_count),this.$set(this,"cart_num",this.storeInfo.once_max_count),this.$util.Tips({title:"单次购买件数不能超过"+this.storeInfo.once_max_count+"件！"})}else if(n.cart_num--,n.cart_num<1&&(this.$set(this.attr.productSelect,"cart_num",1),this.$set(this,"cart_num",1)),n.cart_num<this.storeInfo.once_min_count&&0!=this.storeInfo.once_min_count)return this.$set(this.attr.productSelect,"cart_num",this.storeInfo.once_min_count),this.$set(this,"cart_num",this.storeInfo.once_min_count),this.$util.Tips({title:"单次购买件数不能少于"+this.storeInfo.once_min_count+"件！"})}},attrVal:function(t){this.$set(this.attr.productAttr[t.indexw],"index",this.attr.productAttr[t.indexw].attr_values[t.indexn])},ChangeAttr:function(t){var e=this.productValue[t];e&&this.$set(this,"uniqueValue",e.unique),e&&e.stock>0?(this.$set(this.attr.productSelect,"image",e.image?e.image:this.storeInfo.image),this.$set(this.attr.productSelect,"price",e.price),this.$set(this.attr.productSelect,"svip_price",e.svip_price),this.$set(this.attr.productSelect,"stock",e.stock),this.$set(this.attr.productSelect,"unique",e.unique),this.$set(this,"uniqueValue",e.unique),0==e.stock?this.$set(this.attr.productSelect,"cart_num",0):this.$set(this.attr.productSelect,"cart_num",this.min_count||1),this.$set(this,"attrValue",t),this.$set(this,"attrTxt","选择")):(this.$set(this.attr.productSelect,"image",e.image),this.$set(this.attr.productSelect,"price",e.price),this.$set(this.attr.productSelect,"svip_price",e.svip_price),this.$set(this.attr.productSelect,"stock",0),this.$set(this.attr.productSelect,"unique",""),this.$set(this.attr.productSelect,"cart_num",0),this.$set(this,"attrValue",t),this.$set(this,"attrTxt","选择"))},ChangCoupons:function(t){var e=t,i=this.$util.ArrayRemove(this.couponList,"id",e.id);this.$set(this,"couponList",i),this.getCouponList()},setClientHeight:function(){var e=this,i=t.createSelectorQuery().in(this).select("#list0");i.fields({size:!0},(function(t){e.$set(e,"clientHeight",t.height+20)})).exec()},getGoodsDetails:function(){var e=this;t.showLoading({title:"加载中",mask:!0});var i=this;(0,u.getProductDetail)(i.id).then((function(n){t.hideLoading();var o=n.data;o.video_link&&o.slider_image.length>1?(e.videoCoverImg=o.slider_image[0],o.slider_image.splice(0,1)):o.video_link&&1===o.slider_image.length&&(e.videoCoverImg=o.slider_image[0]),i.$set(i,"storeInfo",o),i.$set(i,"reply",n.data.topReply?[n.data.topReply]:[]),i.$set(i,"replyCount",n.data.replayData&&n.data.replayData.count),i.$set(i,"replyChance",n.data.replayData&&n.data.replayData.rate),i.$set(i.attr,"productAttr",n.data.attr),i.$set(i,"productValue",n.data.sku),i.$set(i.sharePacket,"priceName",n.data.priceName),i.$set(i.sharePacket,"max",n.data.max_extension),i.$set(i.sharePacket,"min",n.data.min_extension),i.$set(i,"systemStore",n.data.system_store),i.$set(i,"storeSelfMention",n.data.store_self_mention),i.$set(i,"PromotionCode",o.code_base),i.$set(i,"activity",n.data.activity?n.data.activity:[]),i.$set(i,"max_count",n.data.once_max_count),i.$set(i,"pay_limit",n.data.pay_limit),i.$set(i,"min_count",n.data.once_min_count),i.$set(i,"svipData",n.data.show_svip_info||null),i.$set(i,"svipPrice",n.data.show_svip_info&&n.data.show_svip_info.show_svip_price||!1),t.setNavigationBarTitle({title:o.store_name.substring(0,7)+"..."}),i.$set(i,"storeImage",i.storeInfo.image),(0,u.getProductParmas)(i.id).then((function(t){i.$set(i,"description",t.data.content),0==i.description.type&&(i.description.content=i.description.content.replace(/<img/gi,'<img style="max-width:100%;height:auto;float:left;display:block" '),i.description.content=i.description.content.replace(/<video/gi,'<video style="width:100%;height:300px;display:block" ')),i.$set(i,"guarantee",t.data.guarantee?t.data.guarantee:[]),i.$set(i,"shippingValue",t.data.temp?t.data.temp.name:""),i.$set(i,"shipping",t.data.temp?t.data.temp.info:""),i.$set(i.specsInfo,"params",t.data.params),i.$set(i.storeInfo,"merchant",t.data.merchant),i.$set(i.storeInfo,"spu_id",t.data.spu_id),i.$set(i.storeInfo,"community",t.data.community),i.$set(i.storeInfo,"atmosphere_pic",t.data.atmosphere_pic),i.$set(i.storeInfo,"top_pid",t.data.top_pid),i.$set(i.storeInfo,"top_num",t.data.top_num),i.$set(i.storeInfo,"top_name",t.data.top_name)})),i.isLogin&&(i.downloadFilePromotionCode(),i.getCartCount()),setTimeout((function(){i.infoScroll()}),500),i.DefaultSelect(),i.getPricrRule(i.storeInfo.cate_id),i.$nextTick((function(){i.getCouponList()}))})).catch((function(t){return i.$util.Tips({title:t},{tab:3,url:1})}))},infoScroll:function(){for(var e=this,i=[],n=[],o=0;o<e.navList.length;o++){var s=t.createSelectorQuery().in(this),r="#past"+o;s.select(r).boundingClientRect(),s.exec((function(t){var o=t[0].top,s=t[0].height;i.push(o),n.push(s),e.$set(e,"topArr",i),e.$set(e,"heightArr",n)}))}},DefaultSelect:function(){var t=this.attr.productAttr,e=[];for(var i in this.productValue)if(this.productValue[i].stock>0){e=this.attr.productAttr.length?i.split(","):[];break}for(var n=0;n<t.length;n++)this.$set(t[n],"index",e[n]);var o=this.productValue[e.join(",")];o&&t.length?(this.$set(this.attr.productSelect,"store_name",this.storeInfo.store_name),this.$set(this.attr.productSelect,"image",o.image?o.image:this.storeInfo.image),this.$set(this.attr.productSelect,"price",o.price),this.$set(this.attr.productSelect,"svip_price",o.svip_price),this.$set(this.attr.productSelect,"stock",o.stock),this.$set(this.attr.productSelect,"unique",o.unique),this.$set(this,"uniqueValue",o.unique),this.$set(this,"attrValue",e.join(",")),this.$set(this,"attrTxt","选择"),0==o.stock?this.$set(this.attr.productSelect,"cart_num",0):this.$set(this.attr.productSelect,"cart_num",this.min_count||1)):!o&&t.length?(this.$set(this.attr.productSelect,"store_name",this.storeInfo.store_name),this.$set(this.attr.productSelect,"image",this.storeInfo.image),this.$set(this.attr.productSelect,"price",this.storeInfo.price),this.$set(this.attr.productSelect,"svip_price",this.storeInfo.svip_price),this.$set(this.attr.productSelect,"stock",0),this.$set(this.attr.productSelect,"unique",""),this.$set(this,"uniqueValue",""),this.$set(this.attr.productSelect,"cart_num",0),this.$set(this,"attrValue",""),this.$set(this,"attrTxt","选择")):o||t.length?o&&!t.length&&(this.$set(this.attr.productSelect,"store_name",this.storeInfo.store_name),this.$set(this.attr.productSelect,"image",o.image),this.$set(this.attr.productSelect,"price",o.price),this.$set(this.attr.productSelect,"svip_price",o.svip_price),this.$set(this.attr.productSelect,"stock",o.stock),this.$set(this.attr.productSelect,"unique",o.unique),this.$set(this,"uniqueValue",o.unique),this.$set(this,"attrValue",e.join(",")),this.$set(this,"attrTxt","选择"),0==o.stock?this.$set(this.attr.productSelect,"cart_num",0):this.$set(this.attr.productSelect,"cart_num",this.min_count||1)):(this.$set(this.attr.productSelect,"store_name",this.storeInfo.store_name),this.$set(this.attr.productSelect,"image",this.storeInfo.image),this.$set(this.attr.productSelect,"price",this.storeInfo.price),this.$set(this.attr.productSelect,"svip_price",this.storeInfo.svip_price),this.$set(this.attr.productSelect,"stock",this.storeInfo.stock),this.$set(this.attr.productSelect,"unique",this.storeInfo.unique||""),this.$set(this,"uniqueValue",this.storeInfo.unique||""),this.$set(this.attr.productSelect,"cart_num",1),this.$set(this,"attrValue",""),this.$set(this,"attrTxt","选择"))},getCouponList:function(){var t=this,e=[],i=[],n=[];(0,d.getCoupons)({ids:t.id}).then((function(o){e=o.data,(0,d.getShopCoupons)(t.storeInfo.mer_id).then((function(o){var s=o.data;i=e.concat(s),t.$set(t.coupon,"list",i);for(var r=0;r<i.length;r++)!i[r].issue&&n.length<2&&n.push(i[r]);t.$set(t,"couponList",n)}))}))},ChangCouponsUseState:function(t){this.$set(this.coupon,"coupon",!1)},setCollect:function(){if(!1===this.isLogin)(0,m.toLogin)();else{var t=this;this.storeInfo.isRelation?(0,u.collectDel)({type:0,type_id:this.id}).then((function(e){t.$set(t.storeInfo,"isRelation",!t.storeInfo.isRelation)})):(0,u.collectAdd)({type_id:this.id,type:0}).then((function(e){t.$set(t.storeInfo,"isRelation",!t.storeInfo.isRelation)}))}},selecAttr:function(){this.$set(this.attr,"cartAttr",!0),this.$set(this,"isOpen",!0)},couponTap:function(){!1===this.isLogin?(0,m.toLogin)():this.$set(this.coupon,"coupon",!0)}},(0,a.default)(o,"couponTap",(function(){!1===this.isLogin?(0,m.toLogin)():this.$set(this.coupon,"coupon",!0)})),(0,a.default)(o,"goCustomer",(function(){!1===this.isLogin?(0,m.toLogin)():t.navigateTo({url:"/pages/chat/customer_list/chat?mer_id=".concat(this.storeInfo.mer_id,"&uid=").concat(this.uid,"&productId=").concat(this.id)})})),(0,a.default)(o,"onMyEvent",(function(){this.$set(this.attr,"cartAttr",!1),this.$set(this,"isOpen",!1)})),(0,a.default)(o,"joinCart",(function(t){!1===this.isLogin?(0,m.toLogin)():this.goCat()})),(0,a.default)(o,"goCat",(function(e){var i=this,n=i.productValue[this.attrValue];if(i.attrValue?i.attr.cartAttr=!i.isOpen:i.isOpen?i.attr.cartAttr=!0:i.attr.cartAttr=!i.attr.cartAttr,!0===i.attr.cartAttr&&!1===i.isOpen)return i.isOpen=!0;if(i.isOpen=i.attr.cartAttr=!0,i.attr.productAttr.length&&!0===i.isOpen&&0==n.stock)return i.$util.Tips({title:"产品库存不足，请选择其它"});if(0==i.attr.productSelect.cart_num)return i.$util.Tips({title:"购买个数不能为0！"});var o={is_new:void 0===e?0:1,product_id:i.id,cart_num:i.attr.productSelect.cart_num,product_attr_unique:void 0!==i.attr.productSelect?i.attr.productSelect.unique:"",source:this.source,product_type:0,spread_id:this.currSpid};(0,u.postCartAdd)(o).then((function(n){i.isOpen=i.attr.cartAttr=!1;var o=n.data.cart_id;e?t.navigateTo({url:"/pages/users/order_confirm/index?cartId="+o}):i.$util.Tips({title:"添加购物车成功",success:function(){i.getCartCount(!0)}})})).catch((function(t){return i.$util.Tips({title:t})}))})),(0,a.default)(o,"isExceedLimit",(function(){})),(0,a.default)(o,"getCartCount",(function(t){var e=this,i=e.isLogin;i&&(0,h.getCartCounts)().then((function(i){e.CartCount=i.data[0].count,t&&(e.animated=!0,setTimeout((function(){e.animated=!1}),500))}))})),(0,a.default)(o,"goBuy",(function(t){!1===this.isLogin?(0,m.toLogin)():this.goCat(!0)})),(0,a.default)(o,"listenerActionSheet",(function(){!1===this.isLogin?(0,m.toLogin)():this.posters=!0})),(0,a.default)(o,"listenerActionClose",(function(){this.posters=!1,this.currentPage=!1})),(0,a.default)(o,"posterImageClose",(function(){this.posterImageStatus=!1})),(0,a.default)(o,"setDomain",(function(t){return t=t?t.toString():"",t.indexOf("https://")>-1?t:t.replace("http://","https://")})),(0,a.default)(o,"downloadFilePromotionCode",(function(t){var e=this;(0,u.getProductCode)(e.id,{type:"routine",product_type:0}).then(function(){var t=(0,r.default)(s.default.mark((function t(i){return s.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.codeImg=i.data.url,e.$set(e,"isDown",!1);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.$set(e,"isDown",!1),e.$set(e,"PromotionCode","")}))})),(0,a.default)(o,"goFriend",(function(){this.posters=!1,this.currentPage=!1})),(0,a.default)(o,"goPoster",(function(){var e=this;return(0,r.default)(s.default.mark((function i(){var n,o;return s.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(!e.posterImage){i.next=4;break}return e.posterImageStatus=!0,e.posters=!1,i.abrupt("return");case 4:return n=e,n.posters=!1,n.$set(n,"canvasStatus",!0),t.showLoading({title:"海报生成中",mask:!0}),i.t0=n.posterbackgd,i.next=11,n.fileStoreImage(n.storeImage);case 11:return i.t1=i.sent,i.next=14,n.fileStoreImage(n.codeImg);case 14:return i.t2=i.sent,i.next=17,n.fileStoreImage(n.share_pic);case 17:i.t3=i.sent,o=[i.t0,i.t1,i.t2,i.t3],n.$util.goodsPosterCanvas(o,n.storeInfo.store_name,n.storeInfo.price,n.site_name,n.storeInfo.ot_price,(function(t){n.$set(n,"posterImage",t),n.$set(n,"posterImageStatus",!0),n.$set(n,"actionSheetHidden",!n.actionSheetHidden),n.$set(n,"canvasStatus",!1)}),(function(t){n.$set(n,"canvasStatus",!1)}));case 20:case"end":return i.stop()}}),i)})))()})),(0,a.default)(o,"fileStoreImage",(function(e){var i=this,n="https:"==e.split("//")[0];return n||(e="https://"+e.split("//")[1]),new Promise((function(n,o){var s=i;t.downloadFile({url:e,success:function(t){n(t.tempFilePath)},fail:function(){return s.$util.Tips({title:""})}})}))})),(0,a.default)(o,"savePosterPath",(function(){var e=this;t.getSetting({success:function(i){i.authSetting["scope.writePhotosAlbum"]?t.saveImageToPhotosAlbum({filePath:e.posterImage,success:function(t){e.posterImageClose(),e.$util.Tips({title:"保存成功",icon:"success"})},fail:function(t){e.$util.Tips({title:"保存失败"})}}):t.authorize({scope:"scope.writePhotosAlbum",success:function(){t.saveImageToPhotosAlbum({filePath:e.posterImage,success:function(t){e.posterImageClose(),e.$util.Tips({title:"保存成功",icon:"success"})},fail:function(t){e.$util.Tips({title:"保存失败"})}})}})}})})),(0,a.default)(o,"imgToBase",(function(t){return(0,r.default)(s.default.mark((function e(){var i;return s.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,l.imgToBase)({image:t});case 2:return i=e.sent,e.abrupt("return",i.data.image);case 4:case"end":return e.stop()}}),e)})))()})),(0,a.default)(o,"copyPwd",(function(){var t=this;(0,u.copyPasswordApi)({id:t.id,product_type:0}).then(function(){var e=(0,r.default)(s.default.mark((function e(i){return s.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.copyUrl=i.data.str,t.posters=!1,t.isCopy=!0;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})),(0,a.default)(o,"closeCopy",(function(){this.isCopy=!1})),(0,a.default)(o,"appShare",(function(e){var i=this;t.showLoading({title:"加载中",mask:!0});var n=getCurrentPages(),o=n[n.length-1].$page.fullPath;t.share({provider:"weixin",scene:e,type:0,href:"".concat(g.HTTP_REQUEST_URL).concat(o,"&spid=").concat(i.uid),title:i.storeInfo.store_name,summary:i.storeInfo.store_info,imageUrl:i.storeInfo.image,success:function(e){t.showToast({title:"分享成功",icon:"success"}),i.posters=!1,t.hideLoading()},fail:function(e){t.showToast({title:"分享失败",icon:"none",duration:2e3}),i.posters=!1,t.hideLoading()}})})),o)};e.default=y}).call(this,i("543d")["default"])},e8a8:function(t,e,i){"use strict";i.r(e);var n=i("c2f0"),o=i.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(s);e["default"]=o.a}},[["a5e9","common/runtime","common/vendor"]]]);