(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/users/user_invoice_form/index"],{1871:function(t,e,i){"use strict";var a=i("3e28"),n=i.n(a);n.a},"3e28":function(t,e,i){},"48a6":function(t,e,i){"use strict";i.r(e);var a=i("6222"),n=i.n(a);for(var c in a)["default"].indexOf(c)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(c);e["default"]=n.a},6222:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=i("6859"),n=i("26cb"),c={components:{home:function(){i.e("components/home/index").then(function(){return resolve(i("4cc1"))}.bind(null,i)).catch(i.oe)}},props:{},computed:(0,n.mapGetters)(["viewColor"]),data:function(){return{loading:!1,id:"",mer_id:"",receipt_title_type:"1",receipt_type:"1",drawer_phone:"",receipt_title:"",duty_paragraph:"",tel:"",address:"",bank_name:"",bank_code:"",is_default:0,email:"",isDefault:[],typeName:"增值税电子普通发票",popupType:!1,popupTitle:!1,invoiceTypeList:[{type:"1",name:"增值税电子普通发票",info:"默认发送至所提供的电子邮件"},{type:"2",name:"增值税专用发票",info:"纸质发票开出后将以邮寄形式交付"}],addInvoice:[]}},onLoad:function(e){e.id&&(this.id=e.id,this.getInvoiceDetail(),this.id&&t.setNavigationBarTitle({title:"编辑发票"})),e.mer_id&&(this.mer_id=e.mer_id)},methods:{getInvoiceDetail:function(){var e=this;t.showLoading({title:"加载中"}),(0,a.invoiceDetail)(this.id).then((function(i){t.hideLoading(),e.receipt_title_type=i.data.receipt_title_type,e.receipt_type=i.data.receipt_type,e.receipt_title=i.data.receipt_title,e.typeName=1==e.receipt_type?"增值税电子普通发票":"增值税专用发票",e.email=i.data.email,e.duty_paragraph=i.data.duty_paragraph,e.bank_name=i.data.bank_name,e.bank_code=i.data.bank_code,e.address=i.data.address,e.tel=i.data.tel,e.is_default=i.data.is_default})).catch((function(i){t.hideLoading(),e.$util.Tips({title:i})}))},formSubmit:function(e){var i=this,n=e.detail.value;if("2"===n.receipt_title_type){if(!n.receipt_title)return this.$util.Tips({title:"请输入需要开具发票的企业名称"});if(!n.duty_paragraph)return this.$util.Tips({title:"请输入纳税人识别码"});if(2==this.receipt_type){if(!n.bank_name)return this.$util.Tips({title:"请输入开户行"});if(!n.bank_code)return this.$util.Tips({title:"请输入银行账号"});if(!/^(\d{9}|\d{14}|\d{18})$/.test(n.bank_code))return this.$util.Tips({title:"请输入正确的银行账号"});if(!/(^(\d{3,4})?\d{7,8})$|(^1(3|4|5|7|8|9|6)\d{9}$)/i.test(n.tel))return this.$util.Tips({title:"请输入正确的电话号码"})}}else if(!n.receipt_title)return this.$util.Tips({title:"请输入需要开具发票的姓名"});if(n.email&&!/^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(n.email))return this.$util.Tips({title:"请输入正确的邮箱"});this.loading=!0,n.receipt_type=this.receipt_type,n.is_default=this.is_default,t.showLoading({title:"保存中",mask:!0}),this.id?(0,a.invoiceUpdate)(this.id,n).then((function(e){t.hideLoading(),i.$util.Tips({title:"添加成功",icon:"success"}),setTimeout((function(){return t.navigateBack({delta:1})}),1e3)})).catch((function(e){t.hideLoading(),i.$util.Tips({title:e}),i.loading=!1})):(0,a.invoiceSave)(n).then((function(e){var a=i;if(t.hideLoading(),a.$util.Tips({title:"添加成功",icon:"success"}),a.mer_id){n.mer_id=a.mer_id,t.getStorage({key:"invoice_Data",success:function(t){a.addInvoice=t.data}});var c=[n];a.addInvoice.length&&a.addInvoice.forEach((function(t,e){t.mer_id==a.mer_id&&a.addInvoice.splice(e,1)})),c=a.addInvoice.length&&a.addInvoice[0]["mer_id"]?c.concat(a.addInvoice):c,t.setStorage({key:"invoice_Data",data:c,success:function(){}})}setTimeout((function(){return t.navigateBack({delta:1})}),1e3)})).catch((function(e){t.hideLoading(),i.$util.Tips({title:e}),i.loading=!1}))},callType:function(){this.popupType=!0},changeType:function(t){var e=this;this.receipt_type=t.detail.value,this.typeName=this.invoiceTypeList.find((function(t){return t.type===e.receipt_type})).name},closeType:function(){this.popupType=!1},callTitle:function(){this.popupTitle=!0},changeTitle:function(t){this.receipt_title=t.detail.value},closeTitle:function(){this.popupTitle=!1},changeHeader:function(t){this.receipt_title_type=t.detail.value,1==t.detail.value&&(this.receipt_type=1,this.typeName="增值税电子普通发票")},changeDefault:function(t){this.is_default=t.detail.value.length?1:0}}};e.default=c}).call(this,i("543d")["default"])},bb9d:function(t,e,i){"use strict";(function(t,e){var a=i("4ea4");i("4c7d");a(i("66fd"));var n=a(i("dc50"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(n.default)}).call(this,i("bc2e")["default"],i("543d")["createPage"])},dc50:function(t,e,i){"use strict";i.r(e);var a=i("e1fc"),n=i("48a6");for(var c in n)["default"].indexOf(c)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(c);i("1871");var d=i("f0c5"),o=Object(d["a"])(n["default"],a["b"],a["c"],!1,null,"1d39cf91",null,!1,a["a"],void 0);e["default"]=o.exports},e1fc:function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){}));var a=function(){var t=this.$createElement;this._self._c},n=[]}},[["bb9d","common/runtime","common/vendor"]]]);