(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/users/user_address/index"],{"3b2d":function(t,e,n){"use strict";(function(t,e){var i=n("4ea4");n("4c7d");i(n("66fd"));var s=i(n("6e49"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(s.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},5770:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){}));var i=function(){var t=this.$createElement,e=(this._self._c,this.addressInfo.length);this.$mp.data=Object.assign({},{$root:{g0:e}})},s=[]},"57a6":function(t,e,n){"use strict";var i=n("87fd"),s=n.n(i);s.a},6554:function(t,e,n){"use strict";(function(t){var i=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=i(n("9523")),d=n("6859"),r=n("58d4"),o=n("26cb"),a=n("736f"),c=n("ddb3");function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){(0,s.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var l={components:{areaWindow:function(){n.e("components/areaWindow/index").then(function(){return resolve(n("b9eb"))}.bind(null,n)).catch(n.oe)}},data:function(){return{cartId:"",pinkId:0,couponId:0,address_id:0,productType:0,userAddress:{is_default:!1},region:["省","市","区"],valueRegion:[0,0,0],district:[],multiArray:[],multiIndex:[0,0,0],cityId:0,display:!1,addressInfo:[],latitude:"",longitude:"",loading:!1}},computed:f(f({},(0,o.mapGetters)(["isLogin","viewColor"])),{},{addressText:function(){return this.addressInfo.map((function(t){return t.name})).join("/")}}),onLoad:function(e){this.isLogin?(this.cartId=e.cartId||"",this.pinkId=e.pinkId||0,this.couponId=e.couponId||0,this.address_id=e.id||0,this.productType=e.product_type||0,t.setNavigationBarTitle({title:e.id?"修改地址":"添加地址"}),this.getUserAddress(),this.getCityList()):(0,c.toLogin)()},methods:{OnChangeAddress:function(t){this.addressInfo=t},getCityList:function(){var t=this;(0,r.getCityV2)(0).then((function(e){t.district=e.data}))},changeRegion:function(){this.display=!0},changeClose:function(){this.display=!1},toggleTab:function(t){this.$refs[t].show()},onConfirm:function(t){this.region=t.checkArr[0]+"-"+t.checkArr[1]+"-"+t.checkArr[2]},getUserAddress:function(){if(!this.address_id)return!1;var t=this;(0,d.getAddressDetail)(this.address_id).then((function(e){var n=[e.data.province,e.data.city,e.data.district];t.$set(t,"userAddress",e.data),t.$set(t,"region",n),t.city_id=e.data.city_id,t.addressInfo=e.data.area}))},getWxAddress:function(){var e=this;t.authorize({scope:"scope.address",success:function(n){t.chooseAddress({success:function(t){(0,r.getCityList)(t.provinceName+"/"+t.cityName+"/"+t.countyName).then((function(t){e.addressInfo=t.data})),e.userAddress.real_name=t.userName,e.userAddress.phone=t.telNumber,e.userAddress.detail=t.detailInfo},fail:function(n){if(t.showToast({title:n.errMsg,icon:"none",duration:1e3}),"chooseAddress:cancel"==n.errMsg)return e.$util.Tips({title:"取消选择"})}})},fail:function(n){t.showModal({title:"您已拒绝导入微信地址权限",content:"是否进入权限管理，调整授权？",success:function(n){if(n.confirm)t.openSetting({success:function(t){}});else if(n.cancel)return e.$util.Tips({title:"已取消！"})}})}})},getAddress:function(){var t=this;t.$wechat.openAddress().then((function(e){(0,r.getCityList)(e.provinceName+"/"+e.cityName+"/"+e.countryName).then((function(e){t.addressInfo=e.data})),t.userAddress.real_name=e.userName,t.userAddress.phone=e.telNumber,t.userAddress.detail=e.detailInfo})).catch((function(t){}))},selfLocation:function(){var e=this;t.showLoading({title:"定位中",mask:!0}),t.getLocation({type:"gcj02",success:function(n){var i,s;i=n.latitude.toString(),s=n.longitude.toString(),e.latitude=n.latitude,e.longitude=n.longitude,(0,a.getGeocoder)({lat:i,long:s}).then((function(n){var i=n.data;(0,r.getCityList)(i.address_component.province+"/"+i.address_component.city+"/"+i.address_component.district+"/"+(i.address_reference.town?i.address_reference.town.title:"")).then((function(n){e.addressInfo=n.data,e.$set(e.userAddress,"detail",i.formatted_addresses.recommend),t.hideLoading()})).catch((function(e){t.hideLoading(),t.showToast({title:"定位失败，请手动输入地址",icon:"none",duration:1e3})}))})).catch((function(e){t.hideLoading(),t.showToast({title:"定位失败，请手动输入地址",icon:"none",duration:1e3})}))},fail:function(e){t.hideLoading(),t.showToast({title:e.errMsg,icon:"none",duration:1e3})}})},formSubmit:function(e){var n=this,i=e.detail.value;return i.real_name?i.phone?/^1(3|4|5|7|8|9|6)\d{9}$/i.test(i.phone)?n.addressInfo.length?i.detail?(i.address_id=n.address_id,i.is_default=n.userAddress.is_default?1:0,i.area=n.addressInfo,t.showLoading({title:"保存中",mask:!0}),n.loading=!0,void(0,d.editAddress)(i).then((function(e){n.address_id?n.$util.Tips({title:"修改成功",icon:"success"}):n.$util.Tips({title:"添加成功",icon:"success"}),setTimeout((function(){if(!n.cartId)return t.navigateBack({delta:1});var i=n.cartId,s=n.pinkId,d=n.couponId;n.cartId="",n.pinkId="",n.couponId="",t.$emit("updataAddress"),20==n.productType?t.navigateTo({url:"/pages/points_mall/integral_order?cartId="+i+"&addressId="+(n.id?n.id:e.data.address_id)+"&pinkId="+s+"&couponId="+d}):t.navigateTo({url:"/pages/users/order_confirm/index?cartId="+i+"&addressId="+(n.id?n.id:e.data.address_id)+"&pinkId="+s+"&couponId="+d}),n.loading=!1}),1e3)})).catch((function(t){return n.loading=!1,n.$util.Tips({title:t})}))):n.$util.Tips({title:"请填写详细地址"}):n.$util.Tips({title:"请选择所在地区"}):n.$util.Tips({title:"请输入正确的手机号码"}):n.$util.Tips({title:"请填写联系电话"}):n.$util.Tips({title:"请填写收货人姓名"})},ChangeIsDefault:function(t){this.$set(this.userAddress,"is_default",!this.userAddress.is_default)}}};e.default=l}).call(this,n("543d")["default"])},"6e49":function(t,e,n){"use strict";n.r(e);var i=n("5770"),s=n("fb6b");for(var d in s)["default"].indexOf(d)<0&&function(t){n.d(e,t,(function(){return s[t]}))}(d);n("57a6");var r=n("f0c5"),o=Object(r["a"])(s["default"],i["b"],i["c"],!1,null,"3f3134fa",null,!1,i["a"],void 0);e["default"]=o.exports},"87fd":function(t,e,n){},fb6b:function(t,e,n){"use strict";n.r(e);var i=n("6554"),s=n.n(i);for(var d in i)["default"].indexOf(d)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(d);e["default"]=s.a}},[["3b2d","common/runtime","common/vendor"]]]);