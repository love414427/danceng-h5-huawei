(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/short_video/nvueSwiper/index"],{3847:function(t,e,i){"use strict";i.r(e);var n=i("6d0b"),a=i("78d8");for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);i("4015"),i("d1fc");var s=i("f0c5"),u=Object(s["a"])(a["default"],n["b"],n["c"],!1,null,"72c73760",null,!1,n["a"],void 0);e["default"]=u.exports},4015:function(t,e,i){"use strict";var n=i("5629"),a=i.n(n);a.a},5629:function(t,e,i){},"680d":function(t,e,i){},"6d0b":function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){}));var n=function(){var t=this,e=t.$createElement,i=(t._self._c,t.__map(t.dataList,(function(e,i){var n=t.__get_orig(e),a=t.max>i?e.isMore||e.content.length<=15:null,o=t.max>i&&!a?e.content.slice(0,15):null,s=t.max>i?1==e.relevance.length&&t.k===i:null,u=t.max>i&&!s?e.relevance.length>1&&t.k===i:null,c=t.max>i?e.relevance.length>0&&t.k===i:null,r=t.max>i&&c?e.relevance.length:null;return{$orig:n,g0:a,g1:o,g2:s,g3:u,g4:c,g5:r}}))),n=!t.dataList.length&&!t.loadVideo;t._isMounted||(t.e0=function(e){t.showManage=!1},t.e1=function(e){e.stopPropagation(),t.showManage=!t.showManage},t.e2=function(e){t.H5ShareBox=!1}),t.$mp.data=Object.assign({},{$root:{l0:i,g6:n}})},a=[]},"732b":function(t,e,i){"use strict";(function(t){var n=i("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a,o=n(i("2eee")),s=n(i("9523")),u=n(i("c973")),c=i("ddb3"),r=i("26cb"),d=i("3255"),l=i("f26a"),h=i("3fd7"),p=i("6859"),f=(n(i("43a2")),getApp()),m={components:{comment:function(){Promise.all([i.e("common/vendor"),i.e("components/comment")]).then(function(){return resolve(i("633e"))}.bind(null,i)).catch(i.oe)},mentioned:function(){Promise.all([i.e("common/vendor"),i.e("components/mentioned")]).then(function(){return resolve(i("94b6"))}.bind(null,i)).catch(i.oe)}},computed:(0,d.configMap)({community_reply_status:0},(0,r.mapGetters)(["isLogin","uid"])),data:function(){return{imgHost:l.HTTP_REQUEST_URL,videoID:0,pinlunNum:0,windowWidth:0,windowHeight:0,platform:"",deleteHeight:0,dataList:[],shareItem:null,k:0,max:2,oldVideo:"",voice:"",timeout:"",authorUid:0,current:0,heightNum:1.3,touchNum:0,aixinLeft:0,aixinTop:0,Rotate:0,currentNav:1,limit:6,page:1,oldCurrent:1,H5ShareBox:!1,showComment:!1,loadVideo:!0,loadend:!1,userInfo:{},moreList:[],posters:!1,weixinStatus:!1,showManage:!1,isUser:!1,isSatrt:0,userUid:0,posterImageStatus:!1,storeImage:"",PromotionCode:"",canvasStatus:!1,posterImage:"",posterbackgd:"../static/img/index/posterbackgd.png",avatar:"/static/images/f.png",codeImg:"",autoplay:!1,circular:!0,interval:3e3,duration:500,actionSheetHidden:!1,isRoutine:!0}},watch:{k:function(e,i){var n=this,a=e+2;if(this.max<a&&(this.max=a),this.oldCurrent!=this.currentNav)return this.oldCurrent=this.currentNav,!1;this.dataList[i].playIng=!1,this.dataList[i].isplay=!0,this.dataList[i].state="pause",t.createVideoContext(this.dataList[i].community_id+""+i,this).pause(),this.dataList[e].state="play",this.dataList[e].isplay=!1,this.dataList[e].playIng=!0,setTimeout((function(){t.createVideoContext(n.dataList[e].community_id+""+e,n).play()}),250),this.videoShare(this.dataList[e])}},onLoad:function(t){this.getOptions(t),this.videoID=t.id,this.isUser=1==t.user,this.userUid=t.uid?t.uid:0,this.isSatrt=1==t.tab?1:0,this.get(),this.isLogin&&(this.getUserInfo(),this.downloadFilePromotionCode(this.videoID))},onShow:function(){},onHide:function(){this.dataList[this.k].state="pause",t.createVideoContext(this.dataList[this.k].community_id+""+this.k,this).pause()},onReady:function(){this.windowWidth=t.getSystemInfoSync().windowWidth,this.windowHeight=t.getSystemInfoSync().windowHeight},onShareAppMessage:function(t){var e=this.uid?this.uid:0;return{title:this.shareItem.title||"",path:"/pages/short_video/nvueSwiper/index?id="+this.shareItem.community_id+"&pid="+e,imageUrl:this.shareItem.image[0]||""}},onShareTimeline:function(t){return{title:this.shareItem.title||"",query:{id:this.shareItem.community_id,pid:this.uid},imageUrl:this.shareItem.image[0]||""}},methods:(a={videoShare:function(e){this.shareItem=e,e&&1==e.status?t.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]}):t.hideShareMenu()},navTap:function(t){this.currentNav=t,this.dataList.forEach((function(t){t.state="pause"})),this.k=0,this.page=1,this.loadVideo=!0,this.loadend=!1,this.dataList=[],1==t?this.get():this.getFocusList()},getUserInfo:function(){var t=this;(0,p.getUserInfo)().then((function(e){t.userInfo=e.data}))},followAuthor:function(e){var i=this;if(!1===this.isLogin)(0,c.toLogin)();else{(0,h.followAuthorApi)(e.uid,{status:1}).then((function(t){200===t.status&&(e.is_fans=!0),i.$util.Tips({title:t.message})})).catch((function(e){return t.showToast({title:e,icon:"none",duration:2e3})}))}},deleteTopic:function(e){var i=this;t.showModal({content:"确定要删除该话题么？",success:function(n){n.confirm?(0,h.deletePlantApi)(e.community_id).then((function(n){200===n.status&&(i.$util.Tips({title:n.message}),setTimeout((function(){t.redirectTo({url:"/pages/plantGrass/plant_user/index?id="+e.uid})}),1e3))})):n.cancel}})},play:function(t){this.dataList[t].isplay=!1,this.dataList[t].playIng=!0,this.dataList[t].state="play",this.dataList[t].loading=!1},waiting:function(t){this.dataList[t].loading=!0},pinlunFun:function(t){var e=this;this.pinlunNum=t,this.dataList.forEach((function(t){t.community_id==e.videoID&&(t.count_reply=t.count_reply+1)}))},getOptions:function(t){if(t.scene){var e=this.$util.getUrlParams(decodeURIComponent(t.scene));e.pid&&(f.globalData.spid=e.pid)}t.pid&&(f.globalData.spid=t.pid)},moreTap:function(t){t.isMore=!t.isMore},moveHandle:function(){},closeScrollview:function(){this.showComment=!1},toComment:function(t,e){this.showComment=!0,this.$refs.comments.getData(t,e)},ended:function(){},tapVideoHover:function(e,i){var n=this;this.touchNum++,setTimeout((function(){1==n.touchNum&&(n.dataList[n.k].state="play"==e||"continue"==e?"pause":"continue","continue"==n.dataList[n.k].state&&t.createVideoContext(n.dataList[n.k].community_id+""+n.k,n).play(),"pause"==n.dataList[n.k].state&&t.createVideoContext(n.dataList[n.k].community_id+""+n.k,n).pause()),n.touchNum=0}),200)},change:function(t){this.k=t.detail.current,this.posterImage=!1,this.isLogin&&this.dataList[this.k]&&this.downloadFilePromotionCode(this.dataList[this.k]["community_id"])},animationfinish:function(t){this.k==this.dataList.length-1&&(this.loadVideo=!0,1==this.currentNav?this.GET():this.getFocusList())},GET:function(){var e=this;e.loadVideo&&(e.loadend||(e.loadVideo=!0,e.isUser?(0,h.myVideoList)(e.userUid,{page:e.page,limit:e.limit,is_star:e.isSatrt,community_id:e.videoID}).then((function(t){e.videoData(t.data.list),e.loadVideo=!1,e.loadend=t.data.list.length<e.limit})).catch((function(e){return t.showToast({title:e,icon:"none",duration:2e3})})):(0,h.videoList)({page:e.page,limit:e.limit,id:e.videoID}).then((function(t){e.loadVideo=!1,e.videoData(t.data.list),e.loadend=t.data.list.length<e.limit})).catch((function(e){return t.showToast({title:e,icon:"none",duration:2e3})}))))},get:function(){var e=this;e.isUser?(0,h.myVideoList)(e.userUid,{page:e.page,limit:e.limit,is_star:e.isSatrt,community_id:e.videoID}).then((function(t){e.page=e.page+1,e.videoData(t.data.list)})).catch((function(e){return t.showToast({title:e,icon:"none",duration:2e3})})):(0,h.videoList)({page:e.page,limit:e.limit,id:e.videoID}).then((function(t){e.page=e.page+1,e.videoData(t.data.list)})).catch((function(e){return t.showToast({title:e,icon:"none",duration:2e3})}))},getFocusList:function(){var e=this;e.loadVideo&&(e.loadend||(e.loadVideo=!0,(0,h.focusArticleLst)({page:e.page,limit:e.limit}).then((function(t){e.loadVideo=!1,e.loadend=t.data.list.length<e.limit,e.page=e.page+1,e.videoData(t.data.list)})).catch((function(e){return t.showToast({title:e,icon:"none",duration:2e3})}))))},videoData:function(e){if(0!=e.length){for(var i=e,n=0;n<i.length;n++)i[n]["isMore"]=!1,i[n]["playIng"]=!1,i[n]["state"]="pause",i[n]["isplay"]=!0,i[n]["loading"]=!1,this.dataList.push(i[n]),0==n&&0==this.k&&(this.dataList[0].isplay=!1,this.dataList[0].playIng=!0,this.dataList[0].state="play",this.dataList[0].loading=!1,t.createVideoContext(this.dataList[0].community_id+"0",this).play());0==this.k&&this.videoShare(this.dataList[0])}},share:function(){this.H5ShareBox=!0},listenerActionSheet:function(){!1===this.isLogin?(0,c.toLogin)():this.posters=!0},listenerActionClose:function(){this.posters=!1},posterImageClose:function(){this.posterImageStatus=!1},goFriend:function(){this.posters=!1},downloadFilePromotionCode:function(t){var e=this;(0,h.getVideoCode)(t,{type:"routine"}).then(function(){var t=(0,u.default)(o.default.mark((function t(i){return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.codeImg=i.data.url;case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.$set(e,"PromotionCode","")}))},savePosterPath:function(){var e=this;t.getSetting({success:function(i){i.authSetting["scope.writePhotosAlbum"]?t.saveImageToPhotosAlbum({filePath:e.posterImage,success:function(t){e.posterImageClose(),e.$util.Tips({title:"保存成功",icon:"success"})},fail:function(t){e.$util.Tips({title:"保存失败"})}}):t.authorize({scope:"scope.writePhotosAlbum",success:function(){t.saveImageToPhotosAlbum({filePath:e.posterImage,success:function(t){e.posterImageClose(),e.$util.Tips({title:"保存成功",icon:"success"})},fail:function(t){e.$util.Tips({title:"保存失败"})}})}})}})},goPoster:function(){var e=this;return(0,u.default)(o.default.mark((function i(){var n,a;return o.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(e.isLogin,!e.posterImage){i.next=5;break}return e.posterImageStatus=!0,e.posters=!1,i.abrupt("return");case 5:if(n=e,n.posters=!1,n.$set(n,"canvasStatus",!0),t.showLoading({title:"海报生成中",mask:!0}),!n.dataList[n.k].author.avatar){i.next=23;break}return i.t0=n.posterbackgd,i.next=13,n.fileStoreImage(n.dataList[n.k].image[0]);case 13:return i.t1=i.sent,i.next=16,n.fileStoreImage(n.codeImg);case 16:return i.t2=i.sent,i.next=19,n.fileStoreImage(n.dataList[n.k].author.avatar);case 19:i.t3=i.sent,a=[i.t0,i.t1,i.t2,i.t3],i.next=32;break;case 23:return i.t4=n.posterbackgd,i.next=26,n.fileStoreImage(n.dataList[n.k].image[0]);case 26:return i.t5=i.sent,i.next=29,n.fileStoreImage(n.codeImg);case 29:i.t6=i.sent,i.t7=n.avatar,a=[i.t4,i.t5,i.t6,i.t7];case 32:n.$util.videoPosterCanvas(a,n.dataList[n.k].content,n.dataList[n.k].author.nickname,(function(t){n.$set(n,"posterImage",t),n.$set(n,"posterImageStatus",!0),n.$set(n,"actionSheetHidden",!n.actionSheetHidden),n.$set(n,"canvasStatus",!1)}),(function(t){n.$set(n,"canvasStatus",!1)}));case 33:case"end":return i.stop()}}),i)})))()},fileStoreImage:function(e){var i=this,n="https:"==e.split("//")[0];return n||(e="https://"+e.split("//")[1]),new Promise((function(n,a){t.downloadFile({url:e,success:function(t){n(t.tempFilePath)},fail:function(){return i.$util.Tips({title:""})}})}))}},(0,s.default)(a,"savePosterPath",(function(){var e=this;t.getSetting({success:function(i){i.authSetting["scope.writePhotosAlbum"]?t.saveImageToPhotosAlbum({filePath:e.posterImage,success:function(t){e.posterImageClose(),e.$util.Tips({title:"保存成功",icon:"success"})},fail:function(t){e.$util.Tips({title:"保存失败"})}}):t.authorize({scope:"scope.writePhotosAlbum",success:function(){t.saveImageToPhotosAlbum({filePath:e.posterImage,success:function(t){e.posterImageClose(),e.$util.Tips({title:"保存成功",icon:"success"})},fail:function(t){e.$util.Tips({title:"保存失败"})}})}})}})})),(0,s.default)(a,"imgToBase",(function(t){return(0,u.default)(o.default.mark((function e(){var i;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,p.imgToBase)({image:t});case 2:return i=e.sent,e.abrupt("return",i.data.image);case 4:case"end":return e.stop()}}),e)})))()})),(0,s.default)(a,"cLike",(function(e){if(this.isLogin){var i=e.relevance_id?0:1;(0,h.graphicStartApi)(e.community_id,{status:i}).then((function(t){e.relevance_id?(e.count_start--,e.count_start=0==e.count_start?0:e.count_start,e.relevance_id=!1):(e.count_start++,e.relevance_id=!0)})).catch((function(e){return t.showToast({title:e,icon:"none",duration:2e3})}))}else(0,c.toLogin)()})),(0,s.default)(a,"openMore",(function(t){this.$refs.mentioned.showPopup(),this.moreList=t.relevance,this.authorUid=t.uid})),(0,s.default)(a,"closePopup",(function(){this.$refs.mentioned.closePopup()})),(0,s.default)(a,"goDetail",(function(e){1===e.product_type?t.navigateTo({url:"/pages/activity/goods_seckill_details/index?id=".concat(e.product_id,"&time=").concat(e.stop_time,"&spid=").concat(this.uid)}):2===e.product_type?t.navigateTo({url:"/pages/activity/presell_details/index?id=".concat(e.activity_id,"&spid=").concat(this.uid)}):0===e.product_type?t.navigateTo({url:"/pages/goods_details/index?id=".concat(e.product_id,"&spid=").concat(this.uid)}):4===e.product_type?t.navigateTo({url:"/pages/activity/combination_details/index?id=".concat(e.activity_id,"&spid=").concat(this.uid)}):40===e.product_type&&t.navigateTo({url:"/pages/activity/combination_status/index?id=".concat(e.activity_id,"&spid=").concat(this.uid)})})),a)};e.default=m}).call(this,i("543d")["default"])},"78d8":function(t,e,i){"use strict";i.r(e);var n=i("732b"),a=i.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(o);e["default"]=a.a},9721:function(t,e,i){"use strict";(function(t,e){var n=i("4ea4");i("4c7d");n(i("66fd"));var a=n(i("3847"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(a.default)}).call(this,i("bc2e")["default"],i("543d")["createPage"])},d1fc:function(t,e,i){"use strict";var n=i("680d"),a=i.n(n);a.a}},[["9721","common/runtime","common/vendor"]]]);