(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order_details/index"],{"0794":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o}));var o={uniPopup:function(){return n.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(n.bind(null,"b4af"))}},r=function(){var e=this,t=e.$createElement,n=(e._self._c,e.orderInfo.take?e.orderInfo.take.mer_take_day&&7==e.orderInfo.take.mer_take_day.length:null),o=e.orderInfo.take&&!n?e.__map(e.orderInfo.take.mer_take_day,(function(t,n){var o=e.__get_orig(t),r=e.toChinese(t);return{$orig:o,m0:r}})):null,r=e.cartInfo.length,i=r>0?e.__map(e.orderInfo.takeOrderList,(function(t,n){var o=e.__get_orig(t),r=1==e.orderInfo.order_type&&e.orderInfo.takeOrderList&&e.orderInfo.takeOrderList.length>0;return{$orig:o,g2:r}})):null,a=1==e.orderInfo.is_virtual&&e.orderInfo.order_extend?e.__map(e.orderInfo.order_extend,(function(t,n){var o=e.__get_orig(t),r=t?Array.isArray(t):null;return{$orig:o,g3:r}})):null,s=0==e.isGoodsReturn&&(0!=e.orderInfo.status||0==e.orderInfo.status&&e.refundNum.length!=e.cartInfo.length&&e.orderInfo.refund_status&&e.orderInfo.refund_switch),d=0!=e.isGoodsReturn||0==e.orderInfo.status||2!=e.orderInfo.activity_type||10!=e.orderInfo.status&&11!=e.orderInfo.status||0!=e.orderInfo.presellOrder.activeStatus?null:e._f("filterDay")(e.orderInfo.presellOrder.final_start_time),u=0==e.isGoodsReturn&&0!=e.orderInfo.status&&1==e.orderInfo.status?e.refundNum.length!=e.cartInfo.length&&e.orderInfo.refund_status&&1==e.orderInfo.refund_switch:null,c=0==e.isGoodsReturn&&0!=e.orderInfo.status&&2==e.orderInfo.status?e.refundNum.length!=e.cartInfo.length&&e.orderInfo.refund_status&&1==e.orderInfo.refund_switch:null,f=0==e.isGoodsReturn&&0!=e.orderInfo.status&&3==e.orderInfo.status?e.refundNum.length!=e.cartInfo.length&&e.orderInfo.refund_status&&1==e.orderInfo.refund_switch:null,l=0==e.isGoodsReturn&&0==e.orderInfo.status&&e.refundNum.length!=e.cartInfo.length&&e.orderInfo.refund_status&&e.orderInfo.refund_switch;e.$mp.data=Object.assign({},{$root:{g0:n,l0:o,g1:r,l1:i,l2:a,g4:s,f0:d,g5:u,g6:c,g7:f,g8:l}})},i=[]},"24e2":function(e,t,n){"use strict";var o=n("bff2"),r=n.n(o);r.a},"27c0":function(e,t,n){"use strict";(function(e){var o=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n("9523")),i=n("f26a"),a=n("59c6"),s=n("041f"),d=n("4d59"),u=n("6859"),c=(o(n("43a2")),n("26cb")),f=n("3255"),l=n("ddb3");function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}getApp();var p={components:{payment:function(){Promise.all([n.e("common/vendor"),n.e("components/payment/index")]).then(function(){return resolve(n("fecf"))}.bind(null,n)).catch(n.oe)},orderGoods:function(){Promise.all([n.e("common/vendor"),n.e("components/orderGoods/index")]).then(function(){return resolve(n("d49b"))}.bind(null,n)).catch(n.oe)},addInvoicing:function(){n.e("components/addInvoicing/index").then(function(){return resolve(n("ab68"))}.bind(null,n)).catch(n.oe)},zbCode:function(){Promise.all([n.e("common/vendor"),n.e("components/zb-code/zb-code")]).then(function(){return resolve(n("17f1"))}.bind(null,n)).catch(n.oe)}},data:function(){return{order_id:"",evaluate:0,activityType:0,cartInfo:[],orderInfo:{system_store:{},_status:{},take:{}},system_store:{},isGoodsReturn:!1,status:{},isClose:!1,payMode:[{name:"微信支付",icon:"icon-weixinzhifu",value:"wechat",title:"微信快捷支付",payStatus:1},{name:"支付宝支付",icon:"icon-zhifubao",value:"alipay",title:"支付宝支付",payStatus:this.$store.getters.globalData.alipay_open},{name:"余额支付",icon:"icon-yuezhifu",value:"balance",title:"可用余额:",number:0,payStatus:this.$store.getters.globalData.yue_pay_status}],pay_close:!1,pay_order_id:"",totalPrice:"0",refundNum:[],imgUrl:i.HTTP_REQUEST_URL,codeUrl:"",isTimePay:!1,codeShow:!1,cid:"1",val:"",size:200,unit:"upx",background:"#FFF",foreground:"#000",pdground:"#32dbc6",icon:"",iconsize:40,lv:3,onval:!0,loadMake:!0,src:"",codeSrc:"",wd:225,hg:500,invoice:{invoice:!1,add:!1}}},computed:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},(0,f.configMap)({hide_mer_status:0,yue_pay_status:0,alipay_open:0},(0,c.mapGetters)(["isLogin","uid","viewColor","keyColor"]))),filters:{filterDay:function(e){if(e){var t=e.replace(/(\d{4})\-(\d{2})\-(\d{2})/,"$2月$3日");return t}}},onLoad:function(e){e.order_id&&this.$set(this,"order_id",e.order_id)},onShow:function(){this.isLogin?(this.getOrderInfo(),this.getUserInfo(),this.isPayBalance()):(0,l.toLogin)()},onHide:function(){this.isClose=!0},onReady:function(){},mounted:function(){},methods:{getPhotoClickIdx:function(t,n){e.previewImage({current:t[n],urls:t})},isPayBalance:function(){10===this.orderInfo.status&&(new Date<new Date(this.orderInfo.presellOrder.final_start_time)?this.isTimePay=!1:new Date>=new Date(this.orderInfo.presellOrder.final_start_time)&&new Date<=new Date(this.orderInfo.presellOrder.final_start_time)&&(this.isTimePay=!0))},toChinese:function(e){var t=["零","一","二","三","四","五","六","日","八","九"],n=["","十","百","千","万"];e=parseInt(e);var o=function(e){for(var o=e.toString().split("").reverse(),r="",i=0;i<o.length;i++)r=(0==i&&0==o[i]||i>0&&0==o[i]&&0==o[i-1]?"":t[o[i]]+(0==o[i]?n[0]:n[i]))+r;return r},r=Math.floor(e/1e4),i=e%1e4;return i.toString().length<4&&(i="0"+i),r?o(r)+"万"+o(i):o(e)},goStore:function(t){1!=this.hide_mer_status&&e.navigateTo({url:"/pages/store/home/index?id="+t})},allRefund:function(){var t=this;(0,d.openOrderRefundSubscribe)().then((function(){e.hideLoading(),0==t.orderInfo.status||0!=t.orderInfo.is_virtual?e.navigateTo({url:"/pages/users/refund/index?order_id="+t.order_id+"&refund_type=1&type=2&order_type="+t.orderInfo.order_type}):e.navigateTo({url:"/pages/users/refund/select?order_id="+t.order_id+"&type=2&order_type="+t.orderInfo.order_type})})).catch((function(){e.hideLoading()}))},getCombinationRemove:function(){var e=this;(0,s.postCombinationRemove)({group_buying_id:e.orderInfo.orderProduct[0].activity_id}).then((function(t){e.$util.Tips({title:t.message},{tab:3})})).catch((function(t){e.$util.Tips({title:t.message})}))},cancelSales:function(){var t=this;e.showModal({content:"确定要取消售后？",success:function(e){e.confirm?deletePlantApi(t.id).then((function(e){200===e.status&&t.$util.Tips({title:e.message})})):e.cancel}})},goGoodCall:function(){e.navigateTo({url:"/pages/chat/customer_list/chat?mer_id=".concat(this.orderInfo.mer_id,"&uid=").concat(this.uid,"&order_id=").concat(this.order_id)})},openSubcribe:function(t){var n=t;e.showLoading({title:"正在加载"}),(0,d.openOrderRefundSubscribe)().then((function(t){e.hideLoading(),e.navigateTo({url:n})})).catch((function(){e.hideLoading()}))},onChangeFun:function(e){var t=e,n=t.action||null,o=void 0!=t.value?t.value:null;n&&this[n]&&this[n](o)},makePhone:function(){e.makePhoneCall({phoneNumber:this.orderInfo.take.mer_take_phone})},call:function(){var t=this;if(!t.orderInfo.merchant.service_phone)return t.$util.Tips({title:"暂无可用客服"});e.showModal({title:"提示",content:"暂无在线客服，确定拨打客服电话:"+t.orderInfo.merchant.service_phone+"吗？",success:function(n){n.confirm&&e.makePhoneCall({phoneNumber:t.orderInfo.merchant.service_phone})}})},showMaoLocation:function(){if(!this.orderInfo.take.mer_take_location[0]||!this.orderInfo.take.mer_take_location[1])return this.$util.Tips({title:"请设置允许商城访问您的位置！"});var t=parseFloat(this.orderInfo.take.mer_take_location[0]),n=parseFloat(this.orderInfo.take.mer_take_location[1]);e.openLocation({latitude:t,longitude:n,address:this.orderInfo.take?this.orderInfo.take.mer_take_name:"",scale:8,success:function(){}})},payClose:function(){this.pay_close=!1},pay_open:function(){this.pay_close=!0,this.pay_order_id=this.orderInfo.order_id.toString(),this.totalPrice=this.orderInfo.pay_price},pay_complete:function(){this.pay_close=!1,this.pay_order_id="",this.getOrderInfo()},pay_fail:function(){this.pay_close=!1,this.pay_order_id=""},getUserInfo:function(){var e=this;(0,u.getUserInfo)().then((function(t){e.payMode[2].number=t.data.now_money}))},getOrderCode:function(){var e=this;(0,a.verifyCode)(this.order_id).then((function(t){e.codeUrl=t.data.qrcode,e.val=t.data.qrcode}))},getOrderInfo:function(){var t=this;e.showLoading({title:"正在加载中"}),(0,a.getOrderDetail)(t.order_id).then((function(n){e.hideLoading(),t.$set(t,"orderInfo",n.data),t.orderInfo.take=n.data.take,t.$set(t,"cartInfo",n.data.orderProduct),"-1"==t.orderInfo.status&&(t.isGoodsReturn=!0),n.data.orderProduct.map((function(e){0==e.refund_num&&t.refundNum.push(e)})),1==n.data.order_type&&t.getOrderCode()})).catch((function(n){e.hideLoading(),t.$util.Tips({title:n},"/pages/users/order_list/index")}))},qrR:function(e){this.codeSrc=e},showCode:function(){this.$refs.cancellPoupon.open()},close:function(){this.$refs.cancellPoupon.close()},copy:function(){e.setClipboardData({data:this.orderInfo.order_sn,success:function(e){}})},copyKm:function(){e.setClipboardData({data:this.orderInfo.delivery_id,success:function(e){}})},goTel:function(){e.makePhoneCall({phoneNumber:this.orderInfo.delivery_id})},goJoinPink:function(){e.navigateTo({url:"/pages/activity/combination_status/index?id="+this.orderInfo.orderProduct[0].activity_id})},goOrderConfirm:function(){var t=this,n=[];this.cartInfo.map((function(e,t){var o={};o.product_id=e.product_id,o.product_attr_unique=e.product_sku,o.cart_num=e.product_num,n.push(o)})),(0,a.orderAgain)({data:n}).then((function(t){var n=t.data.cart_id.join(",");return e.navigateTo({url:"/pages/users/order_confirm/index?cartId="+n})})).catch((function(e){t.$util.Tips({title:e})}))},confirmOrder:function(){var t=this;e.showModal({title:"确认收货",content:"为保障权益，请收到货确认无误后，再确认收货",success:function(e){e.confirm&&(0,a.orderTake)(t.order_id).then((function(e){return t.$util.Tips({title:"操作成功",icon:"success"},(function(){t.getOrderInfo()}))})).catch((function(e){return t.$util.Tips({title:e})}))}})},delOrder:function(){var e=this;(0,a.orderDel)(this.order_id).then((function(t){return e.$util.Tips({title:"删除成功",icon:"success"},{tab:3,url:1})})).catch((function(t){return e.$util.Tips({title:t})}))},cancelOrder:function(){var t=this;e.showModal({title:"提示",content:"确认取消该订单?",success:function(e){e.confirm?(0,a.orderDel)(t.orderInfo.order_id).then((function(e){t.$util.Tips({title:e.msg},{tab:3})})).catch((function(e){return t.$util.Tips({title:e})})):e.cancel}})},applyInvoice:function(){this.invoice.invoice=!0,this.$refs.addInvoicing.getInvoiceDefault(),this.$refs.addInvoicing.getInvoiceList()},changeInvoiceClose:function(e){e&&this.getInvoiceData(e),this.$set(this.invoice,"invoice",!1)},getInvoiceData:function(e){var t=this;(0,a.applyInvoiceApi)(t.order_id,e).then((function(e){return t.$util.Tips({title:e.message})})).catch((function(e){return t.$util.Tips({title:e})}))}}};t.default=p}).call(this,n("543d")["default"])},"2d3e":function(e,t,n){"use strict";n.r(t);var o=n("27c0"),r=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=r.a},3571:function(e,t,n){"use strict";n.r(t);var o=n("0794"),r=n("2d3e");for(var i in r)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(i);n("24e2");var a=n("f0c5"),s=Object(a["a"])(r["default"],o["b"],o["c"],!1,null,"16625395",null,!1,o["a"],void 0);t["default"]=s.exports},a95a:function(e,t,n){"use strict";(function(e,t){var o=n("4ea4");n("4c7d");o(n("66fd"));var r=o(n("3571"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(r.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},bff2:function(e,t,n){}},[["a95a","common/runtime","common/vendor"]]]);