(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/users/user_address/index"],{"20ed":function(t,e,i){},"3b2d":function(t,e,i){"use strict";(function(t,e){var n=i("4ea4");i("4c7d");n(i("66fd"));var s=n(i("6e49"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(s.default)}).call(this,i("bc2e")["default"],i("543d")["createPage"])},"405e":function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){}));var n=function(){var t=this.$createElement,e=(this._self._c,this.addressInfo.length);this.$mp.data=Object.assign({},{$root:{g0:e}})},s=[]},6554:function(t,e,i){"use strict";(function(t){var n=i("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=n(i("9523")),d=i("6859"),r=i("58d4"),o=i("26cb"),a=i("736f");function c(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function u(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?c(Object(i),!0).forEach((function(e){(0,s.default)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var l={components:{areaWindow:function(){i.e("components/areaWindow/index").then(function(){return resolve(i("b9eb"))}.bind(null,i)).catch(i.oe)},authorize:function(){Promise.all([i.e("common/vendor"),i.e("components/Authorize")]).then(function(){return resolve(i("02f6"))}.bind(null,i)).catch(i.oe)}},data:function(){return{cartId:"",pinkId:0,couponId:0,address_id:0,productType:0,userAddress:{is_default:!1},region:["省","市","区"],valueRegion:[0,0,0],isAuto:!1,isShowAuth:!1,district:[],multiArray:[],multiIndex:[0,0,0],cityId:0,display:!1,addressInfo:[],latitude:"",longitude:"",loading:!1}},computed:u(u({},(0,o.mapGetters)(["isLogin","viewColor"])),{},{addressText:function(){return this.addressInfo.map((function(t){return t.name})).join("/")}}),onLoad:function(e){this.isLogin?(this.cartId=e.cartId||"",this.pinkId=e.pinkId||0,this.couponId=e.couponId||0,this.address_id=e.id||0,this.productType=e.product_type||0,t.setNavigationBarTitle({title:e.id?"修改地址":"添加地址"}),this.getUserAddress(),this.getCityList()):(this.isAuto=!0,this.isShowAuth=!0)},methods:{OnChangeAddress:function(t){this.addressInfo=t},getCityList:function(){var t=this;(0,r.getCityV2)(0).then((function(e){t.district=e.data}))},changeRegion:function(){this.display=!0},changeClose:function(){this.display=!1},onLoadFun:function(){this.isShowAuth=!1,this.getUserAddress()},authColse:function(t){this.isShowAuth=t},toggleTab:function(t){this.$refs[t].show()},onConfirm:function(t){this.region=t.checkArr[0]+"-"+t.checkArr[1]+"-"+t.checkArr[2]},getUserAddress:function(){if(!this.address_id)return!1;var t=this;(0,d.getAddressDetail)(this.address_id).then((function(e){var i=[e.data.province,e.data.city,e.data.district];t.$set(t,"userAddress",e.data),t.$set(t,"region",i),t.city_id=e.data.city_id,t.addressInfo=e.data.area}))},getWxAddress:function(){var e=this;t.authorize({scope:"scope.address",success:function(i){t.chooseAddress({success:function(t){(0,r.getCityList)(t.provinceName+"/"+t.cityName+"/"+t.countyName).then((function(t){e.addressInfo=t.data})),e.userAddress.real_name=t.userName,e.userAddress.phone=t.telNumber,e.userAddress.detail=t.detailInfo},fail:function(i){if(t.showToast({title:i.errMsg,icon:"none",duration:1e3}),"chooseAddress:cancel"==i.errMsg)return e.$util.Tips({title:"取消选择"})}})},fail:function(i){t.showModal({title:"您已拒绝导入微信地址权限",content:"是否进入权限管理，调整授权？",success:function(i){if(i.confirm)t.openSetting({success:function(t){}});else if(i.cancel)return e.$util.Tips({title:"已取消！"})}})}})},getAddress:function(){var t=this;t.$wechat.openAddress().then((function(e){(0,r.getCityList)(e.provinceName+"/"+e.cityName+"/"+e.countryName).then((function(e){t.addressInfo=e.data})),t.userAddress.real_name=e.userName,t.userAddress.phone=e.telNumber,t.userAddress.detail=e.detailInfo})).catch((function(t){}))},selfLocation:function(){var e=this;t.showLoading({title:"定位中",mask:!0}),t.getLocation({type:"gcj02",success:function(i){var n,s;n=i.latitude.toString(),s=i.longitude.toString(),e.latitude=i.latitude,e.longitude=i.longitude,(0,a.getGeocoder)({lat:n,long:s}).then((function(i){var n=i.data;(0,r.getCityList)(n.address_component.province+"/"+n.address_component.city+"/"+n.address_component.district+"/"+(n.address_reference.town?n.address_reference.town.title:"")).then((function(i){e.addressInfo=i.data,e.$set(e.userAddress,"detail",n.formatted_addresses.recommend),t.hideLoading()})).catch((function(e){t.hideLoading(),t.showToast({title:"定位失败，请手动输入地址",icon:"none",duration:1e3})}))})).catch((function(e){t.hideLoading(),t.showToast({title:"定位失败，请手动输入地址",icon:"none",duration:1e3})}))},fail:function(e){t.hideLoading(),t.showToast({title:e.errMsg,icon:"none",duration:1e3})}})},formSubmit:function(e){var i=this,n=e.detail.value;return n.real_name?n.phone?/^1(3|4|5|7|8|9|6)\d{9}$/i.test(n.phone)?i.addressInfo.length?n.detail?(n.address_id=i.address_id,n.is_default=i.userAddress.is_default?1:0,n.area=i.addressInfo,t.showLoading({title:"保存中",mask:!0}),i.loading=!0,void(0,d.editAddress)(n).then((function(e){i.address_id?i.$util.Tips({title:"修改成功",icon:"success"}):i.$util.Tips({title:"添加成功",icon:"success"}),setTimeout((function(){if(!i.cartId)return t.navigateBack({delta:1});var n=i.cartId,s=i.pinkId,d=i.couponId;i.cartId="",i.pinkId="",i.couponId="",t.$emit("updataAddress"),20==i.productType?t.navigateTo({url:"/pages/points_mall/integral_order?cartId="+n+"&addressId="+(i.id?i.id:e.data.address_id)+"&pinkId="+s+"&couponId="+d}):t.navigateTo({url:"/pages/users/order_confirm/index?cartId="+n+"&addressId="+(i.id?i.id:e.data.address_id)+"&pinkId="+s+"&couponId="+d}),i.loading=!1}),1e3)})).catch((function(t){return i.loading=!1,i.$util.Tips({title:t})}))):i.$util.Tips({title:"请填写详细地址"}):i.$util.Tips({title:"请选择所在地区"}):i.$util.Tips({title:"请输入正确的手机号码"}):i.$util.Tips({title:"请填写联系电话"}):i.$util.Tips({title:"请填写收货人姓名"})},ChangeIsDefault:function(t){this.$set(this.userAddress,"is_default",!this.userAddress.is_default)}}};e.default=l}).call(this,i("543d")["default"])},"6b16":function(t,e,i){"use strict";var n=i("20ed"),s=i.n(n);s.a},"6e49":function(t,e,i){"use strict";i.r(e);var n=i("405e"),s=i("fb6b");for(var d in s)["default"].indexOf(d)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(d);i("6b16");var r=i("f0c5"),o=Object(r["a"])(s["default"],n["b"],n["c"],!1,null,"11e84aee",null,!1,n["a"],void 0);e["default"]=o.exports},fb6b:function(t,e,i){"use strict";i.r(e);var n=i("6554"),s=i.n(n);for(var d in n)["default"].indexOf(d)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(d);e["default"]=s.a}},[["3b2d","common/runtime","common/vendor"]]]);