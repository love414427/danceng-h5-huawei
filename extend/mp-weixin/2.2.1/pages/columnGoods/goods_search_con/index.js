(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/columnGoods/goods_search_con/index"],{3184:function(t,e,i){"use strict";i.d(e,"b",(function(){return r})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return o}));var o={WaterfallsFlow:function(){return i.e("components/WaterfallsFlow/WaterfallsFlow").then(i.bind(null,"7612"))}},r=function(){var t=this,e=t.$createElement,i=(t._self._c,1==t.tabIndex&&t.is_switch?t.productList.length:null),o=1==t.tabIndex?0==t.productList.length&&!t.loading:null,r=2==t.tabIndex?t.__map(t.storeList,(function(e,i){var o=t.__get_orig(e),r=t.storeList.length;return{$orig:o,g2:r}})):null,s=2==t.tabIndex?!t.storeList.length&&!t.loading:null;t._isMounted||(t.e0=function(e){t.tabIndex=1},t.e1=function(e){t.tabIndex=2},t.e2=function(e){t.downStatus=!t.downStatus}),t.$mp.data=Object.assign({},{$root:{g0:i,g1:o,l0:r,g3:s}})},s=[]},"35e3":function(t,e,i){},"4bd3":function(t,e,i){"use strict";(function(t,e){var o=i("4ea4");i("4c7d");o(i("66fd"));var r=o(i("da0f"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(r.default)}).call(this,i("bc2e")["default"],i("543d")["createPage"])},5192:function(t,e,i){"use strict";(function(t){var o=i("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=o(i("9523")),s=i("736f"),n=i("041f"),a=i("3255"),c=i("26cb"),h=i("f26a"),d=i("f823");i("cd6d");function l(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function u(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?l(Object(i),!0).forEach((function(e){(0,r.default)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}getApp();var f=(0,r.default)({components:{recommend:function(){Promise.all([i.e("common/vendor"),i.e("components/recommend/index")]).then(function(){return resolve(i("1857"))}.bind(null,i)).catch(i.oe)},rightSlider1:function(){i.e("components/rightSlider").then(function(){return resolve(i("c317"))}.bind(null,i)).catch(i.oe)},rightSlider2:function(){i.e("components/rightSlider/index").then(function(){return resolve(i("07dc"))}.bind(null,i)).catch(i.oe)},WaterfallsFlow:function(){i.e("components/WaterfallsFlow/WaterfallsFlow").then(function(){return resolve(i("7612"))}.bind(null,i)).catch(i.oe)},passwordPopup:function(){Promise.all([i.e("common/vendor"),i.e("components/passwordPopup/index")]).then(function(){return resolve(i("5edd"))}.bind(null,i)).catch(i.oe)},authorize:function(){Promise.all([i.e("common/vendor"),i.e("components/Authorize")]).then(function(){return resolve(i("02f6"))}.bind(null,i)).catch(i.oe)}},watch:{tabIndex:function(t,e){1==t?(this.loadend=!1,this.$set(this.where,"page",1),this.get_product_list(!0)):(this.loadend=!1,this.downStatus=!1,this.storeScroll=!0,this.storeList=[],this.storeMerchantList(""))}},data:function(){return{domain:h.HTTP_REQUEST_URL,productList:[],is_switch:!0,where:{cate_id:"",order:"",price_on:"",price_off:"",brand_id:"",keyword:"",is_trader:"",page:1,limit:30},shopTabs:[{title:"默认",key:0,order:""},{title:"销量",key:1,order:"sales"},{title:"好评",key:2,order:"rate"},{title:"距离",key:3,order:"location"}],price:0,stock:0,nows:!1,loadend:!1,loading:!1,loadTitle:"加载更多",title:"",hostProduct:[],hotPage:1,hotLimit:10,hotScroll:!1,rightBox:!1,rightBox2:!1,brandList:[],downKey:0,downStatus:!1,downMenu:[{title:"综合",key:1},{title:"评分",key:2},{title:"新品",key:3}],firstKey:0,tabIndex:1,storeList:[],sotreParam:{keyword:"",page:1,limit:10,order:"",category_id:"",type_id:""},storeKey:0,storeScroll:!0,detaile_address:"",recommend_address:"",latitude:"",longitude:"",mer_location:0,count:0,isAuto:!1,isShowAuth:!1,storeTypeArr:[],merList:[],mTop:0,activeIndex:0}},onLoad:function(t){this.$set(this.where,"cate_id",t.id||""),this.title=t.title||"",this.$set(this.where,"keyword",t.searchValue||""),this.get_product_list(),this.get_host_product(),this.getClassfication(),this.getStoreType()},onReady:function(){},mounted:function(){var e=this;t.getStorage({key:"GLOBAL_DATA",success:function(t){1==t.data.mer_location&&(e.mer_location=t.data.mer_location,e.selfLocation())}}),this.mTop=0==this.hide_mer_status?"238rpx":"170rpx"},computed:u({shopTab:function(){var t=this;return this.shopTabs.filter((function(e){return 1==t.mer_location?e:e.key<3}))}},(0,a.configMap)({margin_ico_switch:0,margin_ico:"",hide_mer_status:0,recommend_switch:0},(0,c.mapGetters)(["uid","isLogin","scrollTop","viewColor","keyColor"]))),onPageScroll:function(){t.$emit("scroll")},methods:{showMaoLocation:function(e,i){if(!e||!i)return this.$util.Tips({title:"请设置允许商城访问您的位置！"});t.openLocation({latitude:parseFloat(e),longitude:parseFloat(i),scale:8,geocode:!0,name:"当前位置",address:this.detaile_address,success:function(t){}})},selfLocation:function(){var e=this;t.getLocation({type:"gcj02",success:function(t){var i,o;i=t.latitude.toString(),o=t.longitude.toString(),e.latitude=t.latitude,e.longitude=t.longitude,(0,s.getGeocoder)({lat:i,long:o}).then((function(t){e.detaile_address=t.data.address,e.recommend_address=t.data.formatted_addresses.recommend}))},complete:function(){}})},getClassfication:function(){var t=this,e=[];(0,s.merClassifly)().then((function(i){e=i.data.map((function(t){return u(u({},t),{},{check:!1})})),t.sotreParam.category_id.length>0&&t.sotreParam.category_id.forEach((function(t,i){e.forEach((function(e){t==e.merchant_category_id&&(e.check=!0)}))})),t.merList=e})).catch((function(e){t.$util.Tips({title:e})}))},getStoreType:function(){var t=this,e=[];(0,s.getStoreTypeApi)().then((function(i){e=i.data.map((function(t){return u(u({},t),{},{check:!1})})),t.sotreParam.type_id.length>0&&t.sotreParam.type_id.forEach((function(t,i){e.forEach((function(e){t==e.mer_type_id&&(e.check=!0)}))})),t.storeTypeArr=e})).catch((function(e){t.$util.Tips({title:e})}))},storeMerchantList:function(t){var e=this;if(this.storeScroll){this.loading=!0;var i={keyword:this.where.keyword,page:this.sotreParam.page,limit:this.sotreParam.limit,order:this.sotreParam.order,category_id:this.sotreParam.category_id,type_id:this.sotreParam.type_id};this.latitude&&(i.location=this.latitude+","+this.longitude),(0,s.storeMerchantList)(i).then((function(t){t.data.list.forEach((function(t){var e=parseFloat(t.product_score)+parseFloat(t.service_score)+parseInt(t.postage_score);e=e/3/5*100,t.allScore=e.toFixed(2)})),e.storeScroll=t.data.list.length>=e.sotreParam.limit,e.storeList=e.storeList.concat(t.data.list),e.count=t.data.count,e.loading=!1}))}},storeTab:function(t){this.loading||(this.storeKey=t,this.sotreParam.order=this.shopTabs[t].order,this.sotreParam.page=1,this.storeScroll=!0,this.storeList=[],this.storeMerchantList())},bindRight:function(){this.price=0,this.firstKey=4,this.getBrandlist()},getBrandlist:function(){var t=this,e=[];(0,s.getBrandlist)({cate_id:this.where.cate_id,keyword:this.where.keyword}).then((function(i){e=i.data.list.map((function(t){return u(u({},t),{},{check:!1})})),t.where.brand_id.length>0&&t.where.brand_id.forEach((function(t,i){e.forEach((function(e){t==e.brand_id&&(e.check=!0)}))})),t.brandList=e,t.rightBox=!0}))},onLoadFun:function(t){this.isShowAuth=!1},authColse:function(t){this.isShowAuth=t},godDetail:function(e){var i=this;(0,d.goShopDetail)(e,this.uid).then((function(o){i.isLogin?(0,n.initiateAssistApi)(e.activity_id).then((function(e){var i=e.data.product_assist_set_id;t.hideLoading(),t.navigateTo({url:"/pages/activity/assist_detail/index?id="+i})})).catch((function(e){t.showToast({title:e,icon:"none"})})):(i.isAuto=!0,i.isShowAuth=!0)}))},confirm:function(t,e){var i=[];0==t.brandList.length?this.where.brand_id="":(t.brandList.forEach((function(t){i.push(t.brand_id)})),this.where.brand_id=i),this.activeIndex=e,this.rightBox=t.status,this.where.price_on=t.price_on,this.where.price_off=t.price_off,this.where.is_trader=t.is_trader,this.loadend=!1,this.$set(this.where,"page",1),this.get_product_list(!0)},bindRight2:function(){this.price=0,this.sotreParam.page=1,this.sotreParam.order="",this.rightBox2=!0},confirm2:function(t){var e=[],i=[];0==t.storeTypeArr.length?this.sotreParam.type_id="":(t.storeTypeArr.forEach((function(t){e.push(t.mer_type_id)})),this.sotreParam.type_id=e.toString()),0==t.merList.length?this.sotreParam.category_id="":(t.merList.forEach((function(t){i.push(t.merchant_category_id)})),this.sotreParam.category_id=i.toString()),this.rightBox2=t.status,this.loadend=!1,this.$set(this.sotreParam,"page",1),this.storeList=[],this.storeScroll=!0,this.storeMerchantList()},close:function(){this.rightBox=!1,this.rightBox2=!1},bindDown:function(t,e){this.firstKey=0,0==e?this.where.order="":1==e?this.where.order="rate":2==e&&(this.where.order="is_new"),this.downKey=e,this.downStatus=!1,this.loadend=!1,this.$set(this.where,"page",1),this.get_product_list(!0)},Changswitch:function(){this.is_switch=!this.is_switch},searchSubmit:function(e){e.detail.value.trim()?(this.$set(this.where,"keyword",e.detail.value),1==this.tabIndex?(this.loadend=!1,this.$set(this.where,"page",1),this.get_product_list(!0)):(this.sotreParam.page=1,this.storeScroll=!0,this.storeList=[],this.storeMerchantList("search"))):t.showToast({title:"请输入搜索内容",icon:"none",duration:1e3})},inputChange:function(t){this.$set(this.where,"keyword",t.detail.value)},get_host_product:function(){var t=this;t.hotScroll||(0,s.getProductHot)(t.hotPage,t.hotLimit).then((function(e){t.hotPage++,t.hotScroll=e.data.list.length<t.hotLimit,t.hostProduct=t.hostProduct.concat(e.data.list)}))},set_where:function(e){switch(this.downStatus=!1,e){case 1:t.navigateBack();break;case 2:this.firstKey=e,0==this.price?(this.price=1,this.where.order="price_asc"):1==this.price?(this.price=2,this.where.order="price_desc"):2==this.price&&(this.price=0,this.where.order=""),this.$set(this.where,"page",1),this.get_product_list(!0);break;case 3:this.price=0,this.loadend=!1,this.$set(this.where,"order","sales"),this.$set(this.where,"page",1),this.get_product_list(!0),this.firstKey=e;break}this.loadend=!1,this.$set(this.where,"page",1),this.get_product_list(!0)},get_product_list:function(t){var e=this;e.loadend||e.loading||(!0===t&&e.$set(e,"productList",[]),e.loading=!0,e.loadTitle="",(0,s.getProductslist)(e.where).then((function(t){var i=t.data.list,o=e.$util.SplitArray(i,e.productList),r=i.length<e.where.limit;e.loadend=r,e.loading=!1,e.loadTitle=r?"已全部加载":"加载更多",e.$set(e,"productList",o),e.$set(e.where,"page",e.where.page+1)})).catch((function(t){e.loading=!1,e.loadTitle="加载更多"})))},goStore:function(e){1!=this.hide_mer_status&&t.navigateTo({url:"/pages/store/home/index?id=".concat(e)})}},onPullDownRefresh:function(){},onReachBottom:function(){if(1==this.tabIndex)this.productList.length>0?this.get_product_list(!1):this.get_host_product();else if(this.count===this.storeList.length){if(0===this.count)return;t.showToast({title:"已加载全部",icon:"none",duration:1e3})}else this.sotreParam.page+=1,this.storeMerchantList()}},"onPullDownRefresh",(function(){var e=this;setTimeout((function(){var i=e.productList.reverse();e.productList=i,t.stopPullDownRefresh()}),500)}));e.default=f}).call(this,i("543d")["default"])},"9c21":function(t,e,i){"use strict";i.r(e);var o=i("5192"),r=i.n(o);for(var s in o)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(s);e["default"]=r.a},da0f:function(t,e,i){"use strict";i.r(e);var o=i("3184"),r=i("9c21");for(var s in r)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return r[t]}))}(s);i("f23a1");var n=i("f0c5"),a=Object(n["a"])(r["default"],o["b"],o["c"],!1,null,"bf2043aa",null,!1,o["a"],void 0);e["default"]=a.exports},f23a1:function(t,e,i){"use strict";var o=i("35e3"),r=i.n(o);r.a}},[["4bd3","common/runtime","common/vendor"]]]);