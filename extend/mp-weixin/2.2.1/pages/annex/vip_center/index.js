(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/annex/vip_center/index"],{7546:function(e,t,n){},7901:function(e,t,n){"use strict";(function(e){var i=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n("9523")),a=n("26cb"),r=n("6859"),s=(n("ddb3"),n("4d59")),c=i(n("569a")),u=n("f26a");function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){(0,o.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p={components:{payment:function(){Promise.all([n.e("common/vendor"),n.e("components/payment/index")]).then(function(){return resolve(n("fecf"))}.bind(null,n)).catch(n.oe)},authorize:function(){Promise.all([n.e("common/vendor"),n.e("components/Authorize")]).then(function(){return resolve(n("02f6"))}.bind(null,n)).catch(n.oe)},easyLoadimage:function(){Promise.all([n.e("common/vendor"),n.e("components/easy-loadimage/easy-loadimage")]).then(function(){return resolve(n("2243"))}.bind(null,n)).catch(n.oe)}},filters:{dateFormat:function(e){return(0,c.default)(e).format("YYYY-MM-DD")},moneyFormat:function(e){return parseFloat(e)}},data:function(){return{domain:u.HTTP_REQUEST_URL,memberType:[],userInfo:{},memberRights:[],memberExplain:[],memberCoupons:[],isGetFree:null,popupShow:!1,account:"",password:"",goodsList:[],pay_order_id:"",payMode:[{name:"微信支付",icon:"icon-weixinzhifu",value:"routine",title:"微信快捷支付",payStatus:!0}],pay_close:!1,totalPrice:"0",formContent:"",page:1,limit:15,finished:!1,loading:!1,memberEndTime:"",type:0,svip_type:1,svip:null,svipDef:{},isAuto:!1,isShowAuth:!1}},watch:{},computed:(0,a.mapGetters)(["isLogin"]),onLoad:function(){this.getCouponLst(),this.isLogin?(this.getMemberCard(),this.memberEquity(),this.groomList()):(this.isAuto=!0,this.isShowAuth=!0)},onShow:function(){},onReachBottom:function(){this.groomList()},methods:{onLunch:function(){this.getMemberCard(),this.memberEquity(),this.getCouponLst()},onLoadFun:function(){this.isShowAuth=!1,this.getMemberCard(),this.memberEquity()},authColse:function(e){this.isShowAuth=e},goUrl:function(t){-1!=t.indexOf("http")||(-1==["/pages/goods_cate/goods_cate","/pages/order_addcart/order_addcart","/pages/user/index","/pages/plant_grass/index"].indexOf(t)?e.navigateTo({url:t}):e.switchTab({url:t}))},getMemberCard:function(){var t=this;e.showLoading({title:"正在加载…"}),(0,r.memberCard)().then((function(n){e.hideLoading(),t.memberType=n.data.list,t.svipDef=n.data.def,t.totalPrice=n.data.def.price.toString(),t.pay_order_id=n.data.def.group_data_id.toString(),t.svip_type=n.data.def.svip_type})).catch((function(t){e.showToast({title:t,icon:"none"})}))},memberEquity:function(){var t=this;(0,r.memberEquity)().then((function(e){t.memberRights=e.data.interests,t.userInfo=e.data.user})).catch((function(t){e.showToast({title:t,icon:"none"})}))},getCouponLst:function(){var t=this;(0,r.memberCouponLst)().then((function(e){t.memberCoupons=e.data})).catch((function(t){e.showToast({title:t,icon:"none"})}))},receiveCoupon:function(t){!1===this.isLogin?(this.isAuto=!0,this.isShowAuth=!0):(0,r.receiveMemberCoupon)(t.coupon_id).then((function(n){t.svipIssue=1,e.showToast({title:n.message,icon:"none"})})).catch((function(t){e.showToast({title:t,icon:"none"})}))},pay:function(){0==this.totalPrice?this.createMemberCard("weixin"):this.pay_close=!0},payClose:function(){this.pay_close=!1},createMemberCard:function(t){var n=this;e.showLoading({title:"正在加载…"});var i={pay_type:t},o=this.pay_order_id;(0,s.openPaySubscribe)().then((function(){(0,r.memberCardCreate)(o,i).then((function(t){if(!(parseFloat(n.totalPrice)>0))return e.hideLoading(),n.$util.Tips({title:1==n.svip_type?"成功开启0元试用":"续费成功"},(function(){n.onLunch()}));n.callPay(t)})).catch((function(t){e.hideLoading(),e.showToast({title:t,icon:"none"})}))}))},callPay:function(t){var n=this,i=t.data.status,o=(t.data.result.order_id,t.data.result.pay_key),a=t.data.result.config,r="/pages/annx/vip_center/index";switch(i){case"ORDER_EXIST":case"EXTEND_ORDER":case"PAY_ERROR":case"error":return e.hideLoading(),n.payClose(),n.$util.Tips({title:t.message});case"success":return e.hideLoading(),n.payClose(),n.$util.Tips({title:t.message,icon:"success"});case"alipay":case"alipayQr":return e.hideLoading(),n.payClose(),void e.navigateTo({url:"/pages/order_pay_back/index?keyCode="+o+"&url="+a+"&type=11"});case"routine":a.timeStamp=a.timestamp;var s="";s=e.requestOrderPayment?"requestOrderPayment":"requestPayment",e[s](d(d({},a),{},{success:function(t){return e.hideLoading(),n.payClose(),n.$util.Tips({title:"支付成功",icon:"success"},{tab:5,url:r})},fail:function(t){return e.hideLoading(),n.payClose(),n.$util.Tips({title:"取消支付"})}}));break;case"balance":return e.hideLoading(),n.payClose(),n.$util.Tips({title:t.message},{tab:5,url:r})}},payCheck:function(e){this.createMemberCard(e)},onChangeFun:function(e){var t=e,n=t.action||null,i=void 0!=t.value?t.value:null;n&&this[n]&&this[n](i)},scrollToCard:function(){var t=e.createSelectorQuery().in(this);t.select("#card").boundingClientRect((function(t){e.pageScrollTo({scrollTop:t.top})})).exec()},checkType:function(e,t){this.svipDef=e.value,this.type=t,this.svip_type=e.value.svip_type,this.pay_order_id=e.group_data_id.toString(),this.totalPrice=e.value.price.toString()},goDetail:function(t){e.navigateTo({url:"/pages/goods_details/index?id=".concat(t)})},groomList:function(){var e=this;this.finished||this.loading||(this.loading=!0,(0,r.groomList)({page:this.page,limit:this.limit}).then((function(t){e.goodsList=e.goodsList.concat(t.data.list),e.finished=t.data.list.length<e.limit,e.loading=!1,e.page+=1})).catch((function(e){})))}},onPageScroll:function(t){e.$emit("scroll")}};t.default=p}).call(this,n("543d")["default"])},a11c:function(e,t,n){"use strict";n.r(t);var i=n("7901"),o=n.n(i);for(var a in i)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(a);t["default"]=o.a},be76:function(e,t,n){"use strict";(function(e,t){var i=n("4ea4");n("4c7d");i(n("66fd"));var o=i(n("d947"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(o.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},d579:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}));var i={easyLoadimage:function(){return Promise.all([n.e("common/vendor"),n.e("components/easy-loadimage/easy-loadimage")]).then(n.bind(null,"2243"))}},o=function(){var e=this,t=e.$createElement,n=(e._self._c,3!=e.userInfo.is_svip?e._f("dateFormat")(e.userInfo.svip_endtime):null),i=e.memberCoupons.length,o=i>0?e.__map(e.memberCoupons,(function(t,n){var i=e.__get_orig(t),o="0.00"!==t.use_min_price?e._f("moneyFormat")(t.use_min_price):null;return{$orig:i,f1:o}})):null,a=3!=e.userInfo.is_svip?e.__map(e.memberType,(function(t,n){var i=e.__get_orig(t),o=e._f("moneyFormat")(t.value&&t.value.price),a=e._f("moneyFormat")(t.value&&t.value.cost_price);return{$orig:i,f2:o,f3:a}})):null,r=e.goodsList.length;e.$mp.data=Object.assign({},{$root:{f0:n,g0:i,l0:o,l1:a,g1:r}})},a=[]},d947:function(e,t,n){"use strict";n.r(t);var i=n("d579"),o=n("a11c");for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);n("fd63");var r=n("f0c5"),s=Object(r["a"])(o["default"],i["b"],i["c"],!1,null,"59632777",null,!1,i["a"],void 0);t["default"]=s.exports},fd63:function(e,t,n){"use strict";var i=n("7546"),o=n.n(i);o.a}},[["be76","common/runtime","common/vendor"]]]);