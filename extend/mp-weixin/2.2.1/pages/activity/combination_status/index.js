(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/activity/combination_status/index"],{"642e":function(t,i,e){"use strict";e.r(i);var s=e("6724"),o=e("6482");for(var n in o)["default"].indexOf(n)<0&&function(t){e.d(i,t,(function(){return o[t]}))}(n);e("9102");var r=e("f0c5"),a=Object(r["a"])(o["default"],s["b"],s["c"],!1,null,"dc552d20",null,!1,s["a"],void 0);i["default"]=a.exports},6482:function(t,i,e){"use strict";e.r(i);var s=e("84f7"),o=e.n(s);for(var n in s)["default"].indexOf(n)<0&&function(t){e.d(i,t,(function(){return s[t]}))}(n);i["default"]=o.a},6724:function(t,i,e){"use strict";e.d(i,"b",(function(){return s})),e.d(i,"c",(function(){return o})),e.d(i,"a",(function(){}));var s=function(){var t=this,i=t.$createElement,e=(t._self._c,t.pinkAll.length);t._isMounted||(t.e0=function(i){t.H5ShareBox=!1}),t.$mp.data=Object.assign({},{$root:{g0:e}})},o=[]},"84f7":function(t,i,e){"use strict";(function(t){var s=e("4ea4");Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=s(e("2eee")),n=s(e("c973")),r=e("26cb"),a=e("041f"),c=e("736f"),u=getApp(),h={name:"GroupRule",components:{CountDown:function(){e.e("components/countDown/index").then(function(){return resolve(e("628d"))}.bind(null,e)).catch(e.oe)},ProductWindow:function(){e.e("components/productWindow/index").then(function(){return resolve(e("b739"))}.bind(null,e)).catch(e.oe)},home:function(){e.e("components/home/index").then(function(){return resolve(e("4cc1"))}.bind(null,e)).catch(e.oe)},canvasPoster:function(){e.e("pages/activity/combination_poster/index").then(function(){return resolve(e("8036"))}.bind(null,e)).catch(e.oe)},copyPassword:function(){e.e("components/copyPassword/index").then(function(){return resolve(e("5f00"))}.bind(null,e)).catch(e.oe)},authorize:function(){Promise.all([e.e("common/vendor"),e.e("components/Authorize")]).then(function(){return resolve(e("02f6"))}.bind(null,e)).catch(e.oe)}},props:{},data:function(){return{currentPinkOrder:"",isOk:0,pinkBool:0,userBool:0,pinkAll:[],storeCombination:[],storeCombinationHost:[],pinkId:0,count:0,iShidden:!1,isOpen:!1,attr:{cartAttr:!1,productSelect:{image:"",store_name:"",price:"",quota:0,unique:"",cart_num:1,quota_show:0,product_stock:0,num:0},productAttr:[]},cart_num:"",userInfo:{},combinationData:{},posters:!1,weixinStatus:!1,H5ShareBox:!1,isAuto:!1,isShowAuth:!1,attrTxt:"请选择",attrValue:"",posterStatus:!1,posterCompenents:!1,currSpid:"",picData:{bagPic:"",goodsPic:"",codePic:"",title:"",label:"",msg:"",price:""},isCopy:!1,copyUrl:"",justifyLeft:""}},computed:(0,r.mapGetters)(["isLogin","uid","viewColor"]),watch:{isLogin:{handler:function(t,i){t&&this.getCombinationPink()},deep:!0}},onLoad:function(t){if(this.justifyLeft=this.viewColor,t.id&&(this.pinkId=t.id),t.scene){var i=this.$util.getUrlParams(decodeURIComponent(t.scene));i.id&&(this.pinkId=i.id),i.spid&&(u.globalData.spid=i.spid,this.currSpid=i.spid)}0==this.isLogin?(this.isAuto=!0,this.isShowAuth=!0):this.getCombinationPink()},mounted:function(){this.getCombinationProductList(),this.getPosterCode()},onShareAppMessage:function(){var t="/pages/activity/combination_status/index?id="+this.pinkId;return{title:"您的好友"+this.pinkAll[0].nickname+"邀请您参团"+this.storeCombination.store_name,path:t,imageUrl:this.storeCombination.image||""}},onShareTimeline:function(){return{title:"您的好友"+this.pinkAll[0].nickname+"邀请您参团"+this.storeCombination.store_name,query:{id:this.pinkId,spid:this.uid},imageUrl:this.storeCombination.image||""}},methods:{authColse:function(t){this.isShowAuth=t},onLoadFun:function(t){u.globalData.openPages="/pages/activity/combination_status/index?id="+this.pinkId,this.getCombinationPink(),this.isShowAuth=!1},listenerActionSheet:function(){0==this.isLogin?(this.isAuto=!0,this.isShowAuth=!0):this.posters=!this.posters},listenerActionClose:function(){this.posters=!1},goFriend:function(){this.posters=!1},iptCartNum:function(t){this.$set(this.attr.productSelect,"cart_num",t),this.$set(this,"cart_num",t)},attrVal:function(t){this.attr.productAttr[t.indexw].index=this.attr.productAttr[t.indexw].attr_values[t.indexn]},onMyEvent:function(){this.$set(this.attr,"cartAttr",!1),this.$set(this,"isOpen",!1)},ChangeAttr:function(t){this.$set(this,"cart_num",1);var i=this.productValue[t];i?(this.$set(this.attr.productSelect,"image",i.image),this.$set(this.attr.productSelect,"price",i.price),this.$set(this.attr.productSelect,"stock",i.stock),this.$set(this.attr.productSelect,"quota",i.quota),this.$set(this.attr.productSelect,"unique",i.unique),this.$set(this.attr.productSelect,"cart_num",1),this.$set(this.attr.productSelect,"product_stock",i.stock),this.$set(this.attr.productSelect,"quota_show",i.stock),this.$set(this,"attrValue",t),this.$set(this,"attrTxt","已选择")):(this.$set(this.attr.productSelect,"image",this.storeCombination.image),this.$set(this.attr.productSelect,"price",this.storeCombination.price),this.$set(this.attr.productSelect,"quota",0),this.$set(this.attr.productSelect,"unique",""),this.$set(this.attr.productSelect,"cart_num",0),this.$set(this.attr.productSelect,"quota_show",0),this.$set(this.attr.productSelect,"stock",0),this.$set(this.attr.productSelect,"product_stock",0),this.$set(this,"attrValue",""),this.$set(this,"attrTxt","请选择"))},ChangeCartNum:function(t){var i=this.productValue[this.attrValue];if(void 0!==i||this.attr.productAttr.length||(i=this.attr.productSelect),void 0!==i){var e=i.stock||0,s=this.attr.productSelect;t?(s.cart_num++,s.cart_num>e&&(this.$set(this.attr.productSelect,"cart_num",e),this.$set(this,"cart_num",e))):(s.cart_num--,s.cart_num<1&&(this.$set(this.attr.productSelect,"cart_num",1),this.$set(this,"cart_num",1)))}},DefaultSelect:function(){var t=this.attr.productAttr,i=[];for(var e in this.productValue)if(this.productValue[e].stock>0){i=this.attr.productAttr.length?e.split(","):[];break}for(var s=0;s<t.length;s++)this.$set(t[s],"index",i[s]);var o=this.productValue[i.join(",")];o&&t.length?(this.$set(this.attr.productSelect,"store_name",this.storeCombination.store_name),this.$set(this.attr.productSelect,"image",o.image),this.$set(this.attr.productSelect,"price",o.price),this.$set(this.attr.productSelect,"stock",o.stock),this.$set(this.attr.productSelect,"unique",o.unique),this.$set(this.attr.productSelect,"cart_num",1),this.$set(this.attr.productSelect,"product_stock",o.stock),this.$set(this.attr.productSelect,"quota_show",o.stock),this.$set(this,"attrValue",i.join(",")),this.attrValue=i.join(","),this.$set(this,"attrTxt","已选择")):!o&&t.length?(this.$set(this.attr.productSelect,"store_name",this.storeCombination.store_name),this.$set(this.attr.productSelect,"image",this.storeCombination.image),this.$set(this.attr.productSelect,"price",this.storeCombination.price),this.$set(this.attr.productSelect,"stock",0),this.$set(this.attr.productSelect,"unique",""),this.$set(this.attr.productSelect,"cart_num",0),this.$set(this.attr.productSelect,"product_stock",0),this.$set(this.attr.productSelect,"quota_show",0),this.$set(this,"attrValue",""),this.$set(this,"attrTxt","请选择")):o||t.length?o&&!t.length&&(this.$set(this.attr.productSelect,"store_name",this.storeCombination.store_name),this.$set(this.attr.productSelect,"image",o.image),this.$set(this.attr.productSelect,"price",o.price),this.$set(this.attr.productSelect,"stock",o.stock),this.$set(this.attr.productSelect,"unique",o.unique),this.$set(this.attr.productSelect,"quota_show",o.stock),this.$set(this,"attrValue",i.join(",")),this.$set(this,"attrTxt","已选择"),0==o.stock?this.$set(this.attr.productSelect,"cart_num",0):this.$set(this.attr.productSelect,"cart_num",1)):(this.$set(this.attr.productSelect,"store_name",this.storeCombination.store_name),this.$set(this.attr.productSelect,"image",this.storeCombination.image),this.$set(this.attr.productSelect,"price",this.storeCombination.price),this.$set(this.attr.productSelect,"stock",0),this.$set(this.attr.productSelect,"unique",this.storeCombination.unique||""),this.$set(this.attr.productSelect,"cart_num",1),this.$set(this.attr.productSelect,"quota_show",0),this.$set(this.attr.productSelect,"product_stock",0),this.$set(this,"attrValue",""),this.$set(this,"attrTxt","请选择"))},setProductSelect:function(){var t=this.attr;t.productSelect.image=this.storeCombination.image,t.productSelect.store_name=this.storeCombination.store_name,t.productSelect.price=this.storeCombination.price,t.productSelect.quota=0,t.productSelect.quota_show=this.storeCombination.stock,t.productSelect.stock=this.storeCombination.stock,t.productSelect.product_stock=this.storeCombination.stock,t.cartAttr=!1,this.$set(this,"attr",t)},pay:function(){this.attr.cartAttr=!0,this.isOpen=!0},goPay:function(){var i=this,e={product_id:i.combinationData.product_group_id,product_attr_unique:void 0!==i.attr.productSelect?i.attr.productSelect.unique:"",cart_num:i.attr.productSelect.cart_num,product_type:4,is_new:1,group_buying_id:i.combinationData.group_buying_id};(0,c.postCartAdd)(e).then((function(i){t.navigateTo({url:"/pages/users/order_confirm/index?new=1&cartId="+i.data.cart_id})})).catch((function(t){i.$util.Tips({title:t})}))},goPoster:function(){this.posters=!1,this.posterStatus=!0},goOrder:function(){t.navigateTo({url:"/pages/order_details/index?order_id="+this.currentPinkOrder})},goList:function(){t.navigateTo({url:"/pages/activity/combination/index"})},goDetail:function(i){this.pinkId=i,t.navigateTo({url:"/pages/activity/combination_details/index?id="+i})},getPosterCode:function(){var t=this;(0,c.getProductCode)(this.pinkId,{type:"routine",product_type:40}).then((function(i){t.picData.codePic=i.data.url})).catch((function(i){t.$util.Tips({title:i})}))},copyPwd:function(){var t=this;(0,c.copyPasswordApi)({id:t.pinkId,product_type:40}).then(function(){var i=(0,n.default)(o.default.mark((function i(e){return o.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:t.copyUrl=e.data.str,t.posters=!1,t.isCopy=!0;case 3:case"end":return i.stop()}}),i)})));return function(t){return i.apply(this,arguments)}}())},closeCopy:function(){this.isCopy=!1},getCombinationPink:function(){var i=this,e=this;t.showLoading({title:"加载中",mask:!0}),(0,a.getCombinationPink)(e.pinkId).then((function(s){t.hideLoading(),e.$set(e,"combinationData",s.data),e.$set(e,"storeCombination",s.data.product),e.$set(e,"pinkAll",s.data.groupUser),e.$set(e,"count",s.data.buying_count_num-s.data.yet_buying_num),e.$set(e,"userBool",s.data.create_status),e.$set(e,"pinkBool",s.data.status),e.$set(e,"currentPinkOrder",s.data.self?s.data.self.order_id:""),e.attr.productAttr=s.data.product.attr,e.productValue=s.data.product.sku,e.$set(e.picData,"goodsPic",s.data.product.image),e.$set(e.picData,"title",s.data.product.store_name.length>28?s.data.product.store_name.slice(0,28)+"...":s.data.product.store_name),e.$set(e.picData,"label",s.data.buying_count_num+"人团"),e.$set(e.picData,"price",s.data.product.price),e.$set(e.picData,"msg","市场价：¥ "+s.data.product.ot_price+" 还差 "+e.count+" 人 拼团成功"),i.posterCompenents=!0,e.setProductSelect(),e.DefaultSelect()})).catch((function(e){i.$util.Tips({title:e}),t.redirectTo({success:function(){},fail:function(){t.navigateTo({url:"/pages/index/index"})}})}))},getCombinationProductList:function(){var t=this;(0,a.getCombinationList)({page:1}).then((function(i){var e=i.data.list;t.storeCombinationHost=t.storeCombinationHost.concat(e)})).catch((function(i){t.$util.Tips({title:i})}))},getCombinationRemove:function(){var i=this;t.showModal({title:"提示",content:"确定取消拼团？",success:function(t){if(t.confirm)(0,a.postCombinationRemove)({group_buying_id:i.pinkId}).then((function(t){i.$util.Tips({title:t.message},{tab:3})})).catch((function(t){i.$util.Tips({title:t.message})}));else if(t.cancel)return i.$util.Tips({title:"已取消"})}})},lookAll:function(){this.iShidden=!this.iShidden}}};i.default=h}).call(this,e("543d")["default"])},9102:function(t,i,e){"use strict";var s=e("b8f9"),o=e.n(s);o.a},"949c":function(t,i,e){"use strict";(function(t,i){var s=e("4ea4");e("4c7d");s(e("66fd"));var o=s(e("642e"));t.__webpack_require_UNI_MP_PLUGIN__=e,i(o.default)}).call(this,e("bc2e")["default"],e("543d")["createPage"])},b8f9:function(t,i,e){}},[["949c","common/runtime","common/vendor"]]]);