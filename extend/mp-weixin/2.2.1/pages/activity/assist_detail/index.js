(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/activity/assist_detail/index"],{"17ad":function(t,e,n){},"33ae":function(t,e,n){"use strict";n.r(e);var a=n("7d24"),i=n("5268");for(var s in i)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(s);n("d527");var r=n("f0c5"),o=Object(r["a"])(i["default"],a["b"],a["c"],!1,null,"29696101",null,!1,a["a"],void 0);e["default"]=o.exports},5268:function(t,e,n){"use strict";n.r(e);var a=n("c262"),i=n.n(a);for(var s in a)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(s);e["default"]=i.a},"7d24":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return a}));var a={jyfParser:function(){return Promise.all([n.e("common/vendor"),n.e("components/jyf-parser/jyf-parser")]).then(n.bind(null,"3192"))}},i=function(){var t=this,e=t.$createElement,n=(t._self._c,(t.bargainInfo.yet_assist_count/t.bargainInfo.assist_count*100).toFixed(2)),a=t.bargainInfo.product&&t.bargainInfo.product.content?t.bargainInfo.product.content.content.replace(/<br\/>/gi,""):null;t._isMounted||(t.e0=function(e){t.H5ShareBox=!1}),t.$mp.data=Object.assign({},{$root:{g0:n,g1:a}})},s=[]},"9c9a":function(t,e,n){"use strict";(function(t,e){var a=n("4ea4");n("4c7d");a(n("66fd"));var i=a(n("33ae"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(i.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},c262:function(t,e,n){"use strict";(function(t){var a=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a(n("2eee")),s=a(n("c973")),r=a(n("7037")),o=a(n("9523")),c=n("041f"),u=n("f26a"),d=n("736f"),l=a(n("3f65")),p=(a(n("43a2")),n("26cb")),f=n("3255"),g=n("6859"),h=a(n("c5df")),m=a(n("9673"));function b(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}var v=getApp(),_={components:{passwordPopup:function(){Promise.all([n.e("common/vendor"),n.e("components/passwordPopup/index")]).then(function(){return resolve(n("5edd"))}.bind(null,n)).catch(n.oe)},countDown:function(){n.e("components/countDown/index").then(function(){return resolve(n("628d"))}.bind(null,n)).catch(n.oe)},copyPassword:function(){n.e("components/copyPassword/index").then(function(){return resolve(n("5f00"))}.bind(null,n)).catch(n.oe)},authorize:function(){Promise.all([n.e("common/vendor"),n.e("components/Authorize")]).then(function(){return resolve(n("02f6"))}.bind(null,n)).catch(n.oe)},home:function(){n.e("components/home/index").then(function(){return resolve(n("4cc1"))}.bind(null,n)).catch(n.oe)},"jyf-parser":function(){Promise.all([n.e("common/vendor"),n.e("components/jyf-parser/jyf-parser")]).then(function(){return resolve(n("3192"))}.bind(null,n)).catch(n.oe)}},mixins:[h.default],data:function(){return{countDownDay:"00",countDownHour:"00",countDownMinute:"00",countDownSecond:"00",active:!1,id:0,userInfo:{},bargainUid:0,bargainUserInfo:{},bargainUserId:0,bargainInfo:[],bargainData:{assistSku:[]},offset:0,limit:20,limitStatus:!1,bargainUserHelpList:[],bargainUserHelpInfo:[],bargainUserBargainPrice:0,status:"",bargainCount:[],old_price:0,retunTop:!0,bargainPartake:0,interval:null,userBargainStatus:0,productStock:0,quota:0,userBargainStatusHelp:!0,navH:"",statusPay:"",bargainSumCount:0,bargainPrice:0,datatime:0,offest:"",tagStyle:{img:"width:100%;display:block;",video:"width:100%;"},domain:u.HTTP_REQUEST_URL,H5ShareBox:!1,systemH:0,isAuto:!1,isShowAuth:!1,pages:"",protocol:"",host:"",currSpid:"",posters:!1,actionSheetHidden:!0,posterImageStatus:!1,storeImage:"",PromotionCode:"",canvasStatus:!1,posterImage:"",posterbackgd:"/static/images/posterbackgd.png",isDown:!0,isCopy:!1,copyUrl:"",load:!1}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?b(Object(n),!0).forEach((function(e){(0,o.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},(0,f.configMap)({site_name:"",share_pic:""},(0,p.mapGetters)(["isLogin","uid","viewColor","keyColor"]))),watch:{isLogin:{handler:function(t,e){t&&this.getBargainDetails()},deep:!0}},onLoad:function(e){var n=this;e.spid&&(v.globalData.spid=e.spid,n.currSpid=e.spid),t.getSystemInfo({success:function(t){n.systemH=t.statusBarHeight,n.navH=n.systemH+10}});var a=getCurrentPages();if(a.length,e.scene){var i=l.default.getUrlParams(decodeURIComponent(e.scene));"object"===(0,r.default)(i)?(i.id&&(e.id=i.id),i.bargain&&(e.bargain=i.bargain),i.spid&&(v.globalData.spid=i.spid,n.currSpid=i.spid)):v.globalData.spid=i}e.spid&&(v.globalData.spid=e.spid),e.hasOwnProperty("id")&&(n.id=e.id,n.bargainUid=e.bargain||0),n.isLogin?("undefined"==n.bargainUid&&(n.bargainUid=n.$store.state.app.uid),n.getBargainDetails(),n.downloadFilePromotionCode(),n.getHistory()):(this.isAuto=!0,this.isShowAuth=!0),(0,m.default)(n.currSpid,n.isLogin),t.setNavigationBarTitle({title:"助力详情"})},onShow:function(){},onReady:function(){},methods:{authColse:function(t){this.isShowAuth=t},goBack:function(){t.navigateBack({delta:1})},goProduct:function(){t.navigateTo({url:"/pages/goods_details/index?id=".concat(this.bargainInfo.product.old_product_id)})},goPoster:function(){var e=this;return(0,s.default)(i.default.mark((function n(){var a,s;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!e.posterImage){n.next=4;break}return e.posterImageStatus=!0,e.posters=!1,n.abrupt("return");case 4:return a=e,a.posters=!1,a.$set(a,"canvasStatus",!0),t.showLoading({title:"海报生成中",mask:!0}),n.t0=a.posterbackgd,n.next=11,a.fileStoreImage(a.storeImage);case 11:return n.t1=n.sent,n.next=14,a.fileStoreImage(a.codeImg);case 14:return n.t2=n.sent,n.next=17,a.fileStoreImage(a.share_pic);case 17:n.t3=n.sent,s=[n.t0,n.t1,n.t2,n.t3],a.$util.goodsPosterCanvas(s,a.bargainData.store_name,a.bargainPrice,a.site_name,a.old_price,(function(t){a.$set(a,"posterImage",t),a.$set(a,"posterImageStatus",!0),a.$set(a,"canvasStatus",!1),a.$set(a,"actionSheetHidden",!a.actionSheetHidden)}),(function(t){a.$set(a,"canvasStatus",!1)}));case 20:case"end":return n.stop()}}),n)})))()},imgToBase:function(t){return(0,s.default)(i.default.mark((function e(){var n;return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,g.imgToBase)({image:t});case 2:return n=e.sent,e.abrupt("return",n.data.image);case 4:case"end":return e.stop()}}),e)})))()},fileStoreImage:function(e){var n=this,a="https:"==e.split("//")[0];return a||(e="https://"+e.split("//")[1]),new Promise((function(a,i){var s=n;t.downloadFile({url:e,success:function(t){a(t.tempFilePath)},fail:function(t){return s.$util.Tips({title:"".concat(t)})}})}))},listenerActionSheet:function(){0==this.isLogin?(this.isAuto=!0,this.isShowAuth=!0):this.posters=!this.posters},listenerActionClose:function(){this.posters=!1},posterImageClose:function(){this.posterImageStatus=!1},downloadFilePromotionCode:function(){var t=this;(0,d.getProductCode)(t.id,{type:"wechat",product_type:3}).then(function(){var e=(0,s.default)(i.default.mark((function e(n){return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.codeImg=n.data.url,t.$set(t,"isDown",!1);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.$util.Tips({title:e}),t.posters=!1,t.$set(t,"isDown",!1),t.$set(t,"PromotionCode","")}))},savePosterPath:function(){},copyPwd:function(){var t=this;(0,d.copyPasswordApi)({id:t.id,product_type:30}).then(function(){var e=(0,s.default)(i.default.mark((function e(n){return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.copyUrl=n.data.str,t.posters=!1,t.isCopy=!0;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},closeCopy:function(){this.isCopy=!1},goPay:function(){var e=this,n={product_id:e.bargainInfo.product_assist_set_id,product_attr_unique:e.bargainInfo.product.unique,cart_num:1,product_type:3,is_new:1};(0,d.postCartAdd)(n).then((function(e){t.navigateTo({url:"/pages/users/order_confirm/index?new=1&cartId="+e.data.cart_id})})).catch((function(t){return e.$util.Tips({title:t})}))},getBargainDetails:function(){var t=this,e=t.id;(0,c.getAssistDetail)(e,{type:2}).then((function(e){t.bargainInfo=e.data,t.bargainData=e.data.assist,t.bargainPrice=t.bargainData.assistSku[0].assist_price,t.old_price=t.bargainData.assistSku[0].sku&&t.bargainData.assistSku[0].sku.price||0,t.userInfo=e.data.user,t.bargainSumCount=e.data.yet_assist_count,t.$set(t,"storeImage",t.bargainInfo.product.image),t.datatime=e.data.stopTime,t.pages="/pages/activity/assist_detail/index?id="+t.id,t.bargainUserHelpList=[],t.getBargainUser()})).catch((function(e){t.$util.Tips({title:e},{tab:3})}))},currentBargainUser:function(){var e=this,n=e.bargainInfo.product_assist_id;(0,c.initiateAssistApi)(n).then((function(e){var n=e.data.product_assist_set_id;t.hideLoading(),t.navigateTo({url:"/pages/activity/assist_detail/index?id="+n})})).catch((function(n){t.hideLoading(),e.$util.Tips({title:n})}))},setBargainHelp:function(){var t=this;t.load=!0,(0,c.postAssistHelp)(t.bargainInfo.product_assist_set_id).then((function(e){t.$set(t,"bargainUserHelpList",[]),t.getBargainUser(),t.$util.Tips({title:e.message}),t.getBargainDetails(),t.load=!1})).catch((function(e){t.$util.Tips({title:e}),t.$set(t,"bargainUserHelpList",[]),t.getBargainUser(),t.load=!1}))},getBargainUser:function(){var t=this,e={offset:t.offset,limit:t.limit};(0,c.assistHelpList)(t.id).then((function(n){var a=t.bargainUserHelpList,i=n.data.list.length;a.concat(n.data.list),t.$set(t,"bargainUserHelpList",n.data.list),t.$set(t,"limitStatus",e.limit>i),t.$set(t,"offest",Number(e.offset)+Number(e.limit))}))},goBargainList:function(){t.navigateTo({url:"/pages/activity/assist/index"})},goOrderDetail:function(e){1==e.paid?t.navigateTo({url:"/pages/order_details/index?order_id="+e.order_id}):t.navigateTo({url:"/pages/order_details/stay?order_id="+e.group_order_id})},close:function(){this.$set(this,"active",!1)},onLoadFun:function(t){this.getBargainDetails(),this.isShowAuth=!1,this.downloadFilePromotionCode()},addShareAssist:function(){(0,c.getAssistUser)(this.bargainInfo.product_assist_set_id).then((function(t){}))}},onHide:function(){null!==this.interval&&clearInterval(this.interval)},onUnload:function(){null!==this.interval&&clearInterval(this.interval)},onShareAppMessage:function(){var t={title:"您的好友"+this.userInfo.nickname+"邀请您帮他助力"+this.bargainInfo.product.store_name+" 快去帮忙吧！",path:"/pages/activity/assist_detail/index?id="+this.id+"&spread="+this.uid,imageUrl:this.bargainInfo.product.image};return this.close(),this.addShareAssist(),t}};e.default=_}).call(this,n("543d")["default"])},d527:function(t,e,n){"use strict";var a=n("17ad"),i=n.n(a);i.a}},[["9c9a","common/runtime","common/vendor"]]]);