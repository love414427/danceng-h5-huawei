(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/store/shopStreet/index"],{"2be9":function(t,e,o){"use strict";(function(t){var r=o("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(o("9523")),i=o("736f"),a=o("26cb"),s=(o("f823"),o("3255")),c=o("f26a");function d(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,r)}return o}function u(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?d(Object(o),!0).forEach((function(e){(0,n.default)(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):d(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}getApp();var l={components:{recommend:function(){Promise.all([o.e("common/vendor"),o.e("components/recommend/index")]).then(function(){return resolve(o("1857"))}.bind(null,o)).catch(o.oe)},rightSlider:function(){o.e("components/rightSlider/index").then(function(){return resolve(o("07dc"))}.bind(null,o)).catch(o.oe)},easyLoadimage:function(){Promise.all([o.e("common/vendor"),o.e("components/easy-loadimage/easy-loadimage")]).then(function(){return resolve(o("2243"))}.bind(null,o)).catch(o.oe)}},data:function(){return{domain:c.HTTP_REQUEST_URL,price:0,stock:0,nows:!1,loading:!1,loadingIcon:!0,loadTitle:"加载更多",title:"",hotPage:1,hotLimit:10,hotScroll:!1,rightBox:!1,brandList:[],downKey:0,downStatus:!1,downMenu:[{title:"默认",key:0,order:""},{title:"销量",key:1,order:"sales"},{title:"好评",key:2,order:"rate"},{title:"距离",key:3,order:"location"}],firstKey:0,storeList:[],sotreParam:{keyword:"",page:1,limit:10,order:"",category_id:"",type_id:""},storeKey:0,storeScroll:!0,mer_id:"",sortId:"",price_on:"",price_off:"",detaile_address:"",recommend_address:"",location_address:"",latitude:"",longitude:"",count:0,storeTypeArr:[],merList:[]}},onLoad:function(t){var e=this;this.sotreParam.type_id=t.type_id&&t.type_id.split(",").toString()||"",this.sotreParam.category_id=t.cate_id&&t.cate_id.split(",").toString()||"",this.storeList=[],this.mer_location&&this.selfLocation(),setTimeout((function(){e.storeMerchantList()}),500),this.getClassfication(),this.getStoreType()},computed:u({downMenus:function(){var t=this;return this.downMenu.filter((function(e){return t.mer_location?e:e.key<3}))}},(0,s.configMap)({margin_ico_switch:0,margin_ico:"",mer_location:0,store_street_theme:1,hide_mer_status:""},(0,a.mapGetters)(["viewColor"]))),methods:{getClassfication:function(){var t=this,e=[];(0,i.merClassifly)().then((function(o){e=o.data.map((function(t){return u(u({},t),{},{check:!1})})),t.sotreParam.category_id.length>0&&t.sotreParam.category_id.forEach((function(t,o){e.forEach((function(e){t==e.merchant_category_id&&(e.check=!0)}))})),t.merList=e})).catch((function(e){t.$util.Tips({title:e})}))},getStoreType:function(){var t=this,e=[];(0,i.getStoreTypeApi)().then((function(o){e=o.data.map((function(t){return u(u({},t),{},{check:!1})})),t.sotreParam.type_id.length>0&&t.sotreParam.type_id.forEach((function(t,o){e.forEach((function(e){t==e.mer_type_id&&(e.check=!0)}))})),t.storeTypeArr=e})).catch((function(e){t.$util.Tips({title:e})}))},showMaoLocation:function(e,o){if(!e||!o)return this.$util.Tips({title:"请设置允许商城访问您的位置！"});t.openLocation({latitude:parseFloat(e),longitude:parseFloat(o),name:"当前位置",address:this.location_address,scale:8,success:function(t){}})},showStoreLocation:function(e){if(!e.lat||!e.long)return this.$util.Tips({title:"请设置允许商城访问您的位置！"});t.openLocation({latitude:parseFloat(e.lat),longitude:parseFloat(e.long),scale:8,name:e.mer_name,address:e.mer_address?e.mer_address:"",success:function(t){}})},selfLocation:function(){var e=this;t.getLocation({type:"gcj02",success:function(o){var r,n;r=o.latitude.toString(),n=o.longitude.toString(),e.latitude=o.latitude,e.longitude=o.longitude,(0,i.getGeocoder)({lat:r,long:n}).then((function(t){e.detaile_address=t.data.address,e.location_address=t.data.address,e.recommend_address=t.data.address.length>4?t.data.address.slice(0,4)+"...":t.data.address})).catch((function(e){t.showToast({title:e,icon:"none"})}))},fail:function(e){t.showToast({title:e,icon:"none",duration:1e3})}})},storeMerchantList:function(){var t=this;if(!this.loading){this.loading=!0;var e={keyword:this.sotreParam.keyword,page:this.sotreParam.page,limit:10,order:this.sotreParam.order,category_id:this.sotreParam.category_id,type_id:this.sotreParam.type_id};this.latitude&&(e.location=this.latitude+","+this.longitude),(0,i.storeMerchantList)(e).then((function(e){t.count=e.data.count,t.storeList=t.storeList.concat(e.data.list),t.loading=!1,t.loadingIcon=!1}))}},goStore:function(e){1!=this.hide_mer_status&&t.navigateTo({url:"/pages/store/home/index?id=".concat(e)})},searchSubmit:function(t){this.$set(this.sotreParam,"keyword",t.detail.value),this.set_where(this.firstKey)},bindRight:function(){this.sotreParam.page=1,this.rightBox=!0},confirm:function(t){var e=[],o=[];0==t.storeTypeArr.length?this.sotreParam.type_id="":(t.storeTypeArr.forEach((function(t){e.push(t.mer_type_id)})),this.sotreParam.type_id=e.toString()),0==t.merList.length?this.sotreParam.category_id="":(t.merList.forEach((function(t){o.push(t.merchant_category_id)})),this.sotreParam.category_id=o.toString()),this.rightBox=t.status,this.loadend=!1,this.$set(this.sotreParam,"page",1),this.storeList=[],this.storeMerchantList()},close:function(){this.rightBox=!1},set_where:function(t){this.loading||(this.storeList=[],this.firstKey=t,this.sotreParam.page=1,this.sotreParam.order=this.downMenu[t].order,this.storeMerchantList())},backjJump:function(){t.navigateBack({delta:1})}},onPullDownRefresh:function(){},onReachBottom:function(){if(this.count===this.storeList.length){if(0===this.count)return;t.showToast({title:"已加载全部",icon:"none",duration:1e3})}else this.sotreParam.page+=1,this.storeMerchantList()},onPageScroll:function(e){t.$emit("scroll")}};e.default=l}).call(this,o("543d")["default"])},"59a8":function(t,e,o){"use strict";o.r(e);var r=o("f813"),n=o("8a3a");for(var i in n)["default"].indexOf(i)<0&&function(t){o.d(e,t,(function(){return n[t]}))}(i);o("9dbe");var a=o("f0c5"),s=Object(a["a"])(n["default"],r["b"],r["c"],!1,null,"d6c953c2",null,!1,r["a"],void 0);e["default"]=s.exports},"8a3a":function(t,e,o){"use strict";o.r(e);var r=o("2be9"),n=o.n(r);for(var i in r)["default"].indexOf(i)<0&&function(t){o.d(e,t,(function(){return r[t]}))}(i);e["default"]=n.a},"9dbe":function(t,e,o){"use strict";var r=o("e4bd"),n=o.n(r);n.a},d3af:function(t,e,o){"use strict";(function(t,e){var r=o("4ea4");o("4c7d");r(o("66fd"));var n=r(o("59a8"));t.__webpack_require_UNI_MP_PLUGIN__=o,e(n.default)}).call(this,o("bc2e")["default"],o("543d")["createPage"])},e4bd:function(t,e,o){},f813:function(t,e,o){"use strict";o.d(e,"b",(function(){return n})),o.d(e,"c",(function(){return i})),o.d(e,"a",(function(){return r}));var r={easyLoadimage:function(){return Promise.all([o.e("common/vendor"),o.e("components/easy-loadimage/easy-loadimage")]).then(o.bind(null,"2243"))}},n=function(){var t=this,e=t.$createElement,o=(t._self._c,1==t.store_street_theme?t.__map(t.storeList,(function(e,o){var r=t.__get_orig(e),n=e.care_count<1e4?null:(e.care_count/1e4).toFixed(2),i=e.recommend.length;return{$orig:r,g0:n,g1:i}})):null),r=2==t.store_street_theme?t.__map(t.storeList,(function(e,o){var r=t.__get_orig(e),n=e.care_count<1e4?null:(e.care_count/1e4).toFixed(2),i=e.recommend.length;return{$orig:r,g2:n,g3:i}})):null,n=3==t.store_street_theme?t.__map(t.storeList,(function(e,o){var r=t.__get_orig(e),n=e.care_count<1e4?null:(e.care_count/1e4).toFixed(2),i=e.recommend.length;return{$orig:r,g4:n,g5:i}})):null,i=!t.storeList.length&&!t.loading&&!t.loadingIcon;t.$mp.data=Object.assign({},{$root:{l0:o,l1:r,l2:n,g6:i}})},i=[]}},[["d3af","common/runtime","common/vendor"]]]);