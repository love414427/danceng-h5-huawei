(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/store/settled/index"],{"03e0":function(t,e,i){},"0c7f":function(t,e,i){"use strict";(function(t){var n=i("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(i("2eee")),r=n(i("c973")),o=i("736f"),s=i("6859"),c=i("26cb"),u=i("3255"),h=i("f26a"),l=(getApp(),{components:{"jyf-parser":function(){Promise.all([i.e("common/vendor"),i.e("components/jyf-parser/jyf-parser")]).then(function(){return resolve(i("3192"))}.bind(null,i)).catch(i.oe)},authorize:function(){Promise.all([i.e("common/vendor"),i.e("components/Authorize")]).then(function(){return resolve(i("02f6"))}.bind(null,i)).catch(i.oe)},Verify:function(){i.e("components/verify/verify").then(function(){return resolve(i("496c"))}.bind(null,i)).catch(i.oe)}},data:function(){return{domain:h.HTTP_REQUEST_URL,cartId:"",pinkId:0,couponId:0,isAuto:!1,isShowAuth:!1,text:"获取验证码",codeUrl:"",disabled:!1,isAgree:!1,showProtocol:!1,isShowCode:!1,loading:!1,merchantData:{enterprise_name:"",user_name:"",phone:"",classification:""},validate:!1,successful:!1,keyCode:"",codeVal:"",protocol:this.sys_intention_agree,timer:"",index:0,index1:0,mer_classification:"",array:[{category_name:"",merchant_category_id:""}],storeTypeArr:[{type_name:"",mer_type_id:""}],mer_storeType:"",pics:[],tagStyle:{img:"width:100%;display:block;"},mer_i_id:null,isType:!1}},beforeDestroy:function(){clearTimeout(this.timer)},computed:(0,u.configMap)({sys_intention_agree:""},(0,c.mapGetters)(["isLogin","viewColor","keyColor"])),onLoad:function(e){this.isLogin?(this.getClassfication(),this.getStoreType()):(this.isAuto=!0,this.isShowAuth=!0),e.mer_i_id&&(this.mer_i_id=e.mer_i_id,t.showLoading({title:"获取数据中"}),this.$nextTick((function(){this.getGoodsDetails(e.mer_i_id)})))},onShow:function(){},onReady:function(){},methods:{getConfig:function(){this.isType=!1,this.showProtocol=!0,this.protocol=this.sys_intention_agree},getAgreement:function(){var t=this;t.showProtocol=!0,t.isType=!0,(0,s.getAgreementApi)("sys_merchant_type").then((function(e){t.protocol=e.data.sys_merchant_type}))},getGoodsDetails:function(e){var i=this;(0,o.getGoodsDetails)(e).then((function(e){var n=Object.keys(i.merchantData),a=e.data;n.map((function(t){i.merchantData.enterprise_name=a.mer_name,i.merchantData.user_name=a.name,i.merchantData.phone=a.phone,i.merchantData.classification=a.merchant_category_id,i.merchantData.mer_type=a.mer_type_id})),i.pics=a.images,i.mer_classification=i.getCategoryName(a.merchant_category_id,i.array),i.mer_storeType=i.getStoreTypeName(a.mer_type_id,i.storeTypeArr),t.hideLoading()}))},getCategoryName:function(t,e){for(var i=0;i<e.length;i++)if(e[i].merchant_category_id===t)return e[i]["category_name"]},getStoreTypeName:function(t,e){for(var i=0;i<e.length;i++)if(e[i].mer_type_id===t)return e[i]["type_name"]},bindPickerChange:function(t){this.index=t.target.value;var e=t.target.value;this.merchantData.classification=this.array[e]["merchant_category_id"],this.mer_classification=this.array[e]["category_name"],this.validateBtn()},bindPickerChange1:function(t){this.index1=t.target.value;var e=t.target.value;this.merchantData.mer_type=this.storeTypeArr[e]["mer_type_id"],this.mer_storeType=this.storeTypeArr[e]["type_name"],this.validateBtn()},getClassfication:function(){var t=this;(0,o.merClassifly)().then((function(e){t.array=e.data})).catch((function(e){t.$util.Tips({title:e})}))},getStoreType:function(){var t=this;(0,o.getStoreTypeApi)().then((function(e){t.storeTypeArr=e.data})).catch((function(e){t.$util.Tips({title:e})}))},getPhotoClickIdx:function(t){var e=t.currentTarget.dataset.index;this.imgPreview(this.pics,e)},imgPreview:function(e,i){e&&e.length>0&&t.previewImage({current:e[i],urls:e})},onLoadFun:function(){this.isShowAuth=!1},authColse:function(t){this.isShowAuth=t},toggleTab:function(t){this.$refs[t].show()},goHome:function(){t.switchTab({url:"/pages/index/index"})},again:function(){this.getcaptcha()},uploadpic:function(){var t=this;t.$util.uploadImageOne("upload/image",(function(e){t.pics.push(e.data.path),t.$set(t,"pics",t.pics)}))},DelPic:function(t){this.pics[t];this.pics.splice(t,1),this.$set(this,"pics",this.pics)},getCode:function(){var t=this;getCodeApi().then((function(e){t.keyCode=e.data.key})).catch((function(e){t.$util.Tips({title:e})}))},code:function(t){var e=this;return(0,r.default)(a.default.mark((function i(){var n;return a.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(n=e,n.merchantData.phone){i.next=3;break}return i.abrupt("return",n.$util.Tips({title:"请填写手机号码"}));case 3:if(/^1(3|4|5|7|8|9|6)\d{9}$/i.test(n.merchantData.phone)){i.next=5;break}return i.abrupt("return",n.$util.Tips({title:"请输入正确的手机号码"}));case 5:return i.next=7,(0,o.verify)({phone:n.merchantData.phone,type:"intention",captchaType:"blockPuzzle",captchaVerification:t.captchaVerification}).then((function(t){n.$util.Tips({title:t.msg}),n.sendCode()})).catch((function(t){n.$util.Tips({title:t}),t.status}));case 7:case"end":return i.stop()}}),i)})))()},getcaptcha:function(){var t=this;(0,s.getCaptcha)().then((function(e){t.codeUrl=e.data.captcha,t.codeVal=e.data.code,t.codeKey=e.data.key})),t.isShowCode=!0},sendCode:function(){var t=this;if(!this.disabled){this.disabled=!0;var e=60;this.text="剩余 "+e+"s";var i=setInterval((function(){e-=1,e<0&&clearInterval(i),t.text="剩余 "+e+"s",t.text<"剩余 0s"&&(t.disabled=!1,t.text="重新获取")}),1e3)}},onConfirm:function(t){this.region=t.checkArr[0]+"-"+t.checkArr[1]+"-"+t.checkArr[2]},ChangeIsAgree:function(t){this.isAgree=!this.isAgree,this.validateBtn()},formSubmit:function(t){var e=this,i=this;if(i.validateForm()&&i.validate){var n={phone:i.merchantData.phone,mer_name:i.merchantData.enterprise_name,name:i.merchantData.user_name,code:i.merchantData.yanzhengma,merchant_category_id:i.merchantData.classification,mer_type_id:i.merchantData.mer_type,images:i.pics};i.validate=!1,i.mer_i_id?(0,o.updateGoodsRecord)(i.mer_i_id,n).then((function(t){200==t.status&&(i.loading=!0,i.timer=setTimeout((function(){i.successful=!0,i.validate=!0}),1e3))})).catch((function(t){i.validate=!0,i.$util.Tips({title:t})})):(0,o.create)(n).then((function(t){200==t.status&&(i.loading=!0,e.timer=setTimeout((function(){i.successful=!0,i.validate=!0}),1e3))})).catch((function(t){i.validate=!0,i.$util.Tips({title:t})}))}},validateBtn:function(){var t=this.merchantData;t.enterprise_name&&t.user_name&&t.phone&&/^1(3|4|5|7|8|9|6)\d{9}$/i.test(t.phone)&&t.yanzhengma&&this.isAgree&&t.classification?this.isShowCode?this.codeVal?this.validate=!0:this.validate=!1:this.validate=!0:this.validate=!1},validateForm:function(){var t=this.merchantData;return t.enterprise_name?t.user_name?t.phone?/^1(3|4|5|7|8|9|6)\d{9}$/i.test(t.phone)?t.yanzhengma?t.classification?this.isAgree?this.isShowCode&&!this.codeVal?this.$util.Tips({title:"请填写图片验证码"}):(this.validate=!0,!0):this.$util.Tips({title:"请勾选并同意入驻协议"}):this.$util.Tips({title:"请选择商户分类"}):this.$util.Tips({title:"请填写验证码"}):this.$util.Tips({title:"请输入正确的手机号码"}):this.$util.Tips({title:"请输入手机号"}):this.$util.Tips({title:"请输入姓名"}):this.$util.Tips({title:"请输入企业名称"})},jumpToList:function(){t.navigateTo({url:"/pages/store/applicationRecord/index"})},success:function(t){this.$refs.verify.hide(),this.code(t)},handleVerify:function(){return this.merchantData.phone?/^1(3|4|5|7|8|9|6)\d{9}$/i.test(this.merchantData.phone)?this.isAgree?void this.$refs.verify.show():this.$util.Tips({title:"请勾选并同意入驻协议"}):this.$util.Tips({title:"请输入正确的手机号码"}):this.$util.Tips({title:"请输入手机号"})}}});e.default=l}).call(this,i("543d")["default"])},"238b":function(t,e,i){"use strict";i.r(e);var n=i("71e6"),a=i("2599");for(var r in a)["default"].indexOf(r)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(r);i("9ed6");var o=i("f0c5"),s=Object(o["a"])(a["default"],n["b"],n["c"],!1,null,"e198d8c8",null,!1,n["a"],void 0);e["default"]=s.exports},2599:function(t,e,i){"use strict";i.r(e);var n=i("0c7f"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(r);e["default"]=a.a},"3e6e":function(t,e,i){"use strict";(function(t,e){var n=i("4ea4");i("4c7d");n(i("66fd"));var a=n(i("238b"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(a.default)}).call(this,i("bc2e")["default"],i("543d")["createPage"])},"71e6":function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return r})),i.d(e,"a",(function(){return n}));var n={jyfParser:function(){return Promise.all([i.e("common/vendor"),i.e("components/jyf-parser/jyf-parser")]).then(i.bind(null,"3192"))}},a=function(){var t=this,e=t.$createElement,i=(t._self._c,t.successful?null:t.pics.length);t._isMounted||(t.e0=function(e){e.stopPropagation(),t.mer_storeType=""},t.e1=function(e){t.showProtocol=!1}),t.$mp.data=Object.assign({},{$root:{g0:i}})},r=[]},"9ed6":function(t,e,i){"use strict";var n=i("03e0"),a=i.n(n);a.a}},[["3e6e","common/runtime","common/vendor"]]]);