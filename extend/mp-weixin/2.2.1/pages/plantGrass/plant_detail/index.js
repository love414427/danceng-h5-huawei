(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/plantGrass/plant_detail/index"],{"0a5d":function(t,e,i){"use strict";i.r(e);var n=i("1640"),o=i("a4ce");for(var l in o)["default"].indexOf(l)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(l);i("f73b");var a=i("f0c5"),s=Object(a["a"])(o["default"],n["b"],n["c"],!1,null,"18efed80",null,!1,n["a"],void 0);e["default"]=s.exports},1640:function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return l})),i.d(e,"a",(function(){return n}));var n={uniPopup:function(){return i.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(i.bind(null,"b4af"))}},o=function(){var t=this,e=t.$createElement,i=(t._self._c,null!=t.followDetail&&t.followDetail?t.followDetail.relevance.length:null),n=null!=t.followDetail&&t.followDetail&&i?t.followDetail.relevance.length:null,o=null!=t.followDetail&&t.followDetail&&1==t.community_reply_status?t.commList.length:null,l=null!=t.followDetail&&t.followDetail&&1==t.community_reply_status&&o>0?t.__map(t.commList,(function(e,i){var n=t.__get_orig(e),o=e.children&&e.children.length>0;return{$orig:n,g3:o}})):null,a=null!=t.followDetail&&t.followDetail&&1==t.community_reply_status?0==t.commList.length&&!t.loading:null;t._isMounted||(t.e0=function(e){e.stopPropagation(),t.showManage=!1},t.e1=function(e){e.stopPropagation(),t.showManage=!t.showManage}),t.$mp.data=Object.assign({},{$root:{g0:i,g1:n,g2:o,l0:l,g4:a}})},l=[]},"3f0a":function(t,e,i){},"7e30":function(t,e,i){"use strict";(function(t){var n=i("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;n(i("3314"));var o=i("f26a"),l=i("6859"),a=i("3fd7"),s=i("26cb"),u=n(i("9673")),r=i("3255"),c=getApp(),d={components:{authorize:function(){Promise.all([i.e("common/vendor"),i.e("components/Authorize")]).then(function(){return resolve(i("02f6"))}.bind(null,i)).catch(i.oe)},productConSwiper:function(){i.e("components/plantConSwiper/index").then(function(){return resolve(i("89a1"))}.bind(null,i)).catch(i.oe)},mentioned:function(){Promise.all([i.e("common/vendor"),i.e("components/mentioned")]).then(function(){return resolve(i("94b6"))}.bind(null,i)).catch(i.oe)},bindmobile:function(){Promise.all([i.e("common/vendor"),i.e("components/bindmobile")]).then(function(){return resolve(i("5802"))}.bind(null,i)).catch(i.oe)}},data:function(){return{domain:o.HTTP_REQUEST_URL,open_grass:o.openPlantGrass,followDetail:null,commList:[],moreList:[],isShowAuth:!1,isAuto:!1,showManage:!1,content:"",id:"",replyData:{},userInfo:{},loadData:!1,loaded:!1,loading:!1,loadTitle:"加载更多",where:{page:1,limit:10},reply_id:"",placeholder:"快来说点儿什么吧...",isChild:!1,index:0,currSpid:"",focus:!1,actionSheetHidden:!0,type:0}},created:function(){},computed:(0,r.configMap)({community_reply_auth:0,community_reply_status:0},(0,s.mapGetters)(["isLogin","uid","viewColor"])),watch:{},onLoad:function(t){this.id=t.id,this.type=t.type,t.spid&&(c.globalData.spid=t.spid,this.currSpid=t.spid),(0,u.default)(this.currSpid,this.isLogin),this.getDetail(),this.getReplyList()},onShow:function(){t.hideLoading()},mounted:function(){},methods:{plantShare:function(){1==this.followDetail.status?t.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"],title:this.followDetail.title||"",imageUrl:this.followDetail.image[0]||"",path:"/pages/plantGrass/plant_detail/index?id="+this.id+"&spid="+this.uid}):t.hideShareMenu()},onLoadFun:function(){this.isShowAuth=!1,this.getDetail(),this.getReplyList()},authColse:function(t){this.isShowAuth=t},authOpen:function(){!1===this.isLogin&&(this.isAuto=!0,this.isShowAuth=!0)},getUserInfo:function(){var t=this;(0,l.getUserInfo)().then((function(e){t.userInfo=e.data,e.data.phone||0==t.community_reply_auth?t.createReply():t.$refs.bindmobile.open()}))},getDetail:function(){var e=this;e.loadData||(e.loadData=!0,t.showLoading({title:"加载中",mask:!0}),(0,a.plantDetailApi)(e.id).then((function(i){e.loadData=!1,e.followDetail=i.data,t.hideLoading(),e.plantShare()})).catch((function(i){return e.followDetail=null,e.loadData=!1,t.hideLoading(),e.$util.Tips({title:i})})))},getReplyList:function(){var e=this;e.loading||e.loaded||(e.loading=!0,e.loadTitle="",(0,a.replyLstApi)(e.id,e.where).then((function(t){e.loading=!1,e.replyData=t.data;var i=t.data.list,n=e.$util.SplitArray(i,e.commList);e.loaded=i.length<e.where.limit,e.loading=!1,e.loadTitle=e.loaded?"已全部加载":"加载更多",e.$set(e,"commList",n),e.$set(e.where,"page",e.where.page+1)})).catch((function(i){e.loading=!1,t.showToast({title:i,icon:"none"})})))},submitComment:function(){!1===this.isLogin?(this.isAuto=!0,this.isShowAuth=!0):this.getUserInfo()},createReply:function(){var e=this,i=e.reply_id?e.reply_id:0;(0,a.replyCreateApi)(e.id,{content:e.content,reply_id:i}).then((function(t){200===t.status&&1==t.data.status&&(e.isChild?e.commList[e.index]["children"]?e.commList[e.index]["children"].push(t.data):e.commList[e.index]["children"]=[t.data]:e.commList.unshift(t.data),e.replyData.all++),e.$util.Tips({title:t.message}),e.loseFocus(),e.content=""})).catch((function(e){t.showToast({title:e,icon:"none"})}))},toReply:function(t,e){this.placeholder="回复："+t.author.nickname,this.reply_id=t.reply_id,this.isChild=!0,this.index=e,this.focus=!0,this.content=""},loseFocus:function(){this.focus=!1,this.reply_id=0,this.placeholder="快来说点儿什么吧...",this.isChild=!1},starComment:function(e){var i=this;if(!1===i.isLogin)this.isAuto=!0,this.isShowAuth=!0;else{var n=e.relevance_id?0:1;(0,a.starCommentApi)(e.reply_id,{status:n}).then((function(t){200===t.status&&(e.relevance_id?(e.count_start--,i.replyData.start--,e.count_start=0==e.count_start?0:e.count_start,i.replyData.start=0==i.replyData.start?0:i.replyData.start,e.relevance_id=!1):(e.count_start++,e.relevance_id=!0,i.replyData.start++)),i.$util.Tips({title:t.message})})).catch((function(e){t.showToast({title:e,icon:"none"})}))}},likeToggle:function(e){var i=this;if(!1===this.isLogin)this.isAuto=!0,this.isShowAuth=!0;else{var n=e?0:1;(0,a.graphicStartApi)(this.followDetail.community_id,{status:n}).then((function(n){e?(i.followDetail.count_start--,i.followDetail.count_start=0==i.followDetail.count_start?0:i.followDetail.count_start,i.followDetail.relevance_id=!1):(i.followDetail.count_start++,i.followDetail.relevance_id=!0),t.$emit("startLike",i.followDetail)}))}},followAuthor:function(){var t=this;if(!1===this.isLogin)this.isAuto=!0,this.isShowAuth=!0;else{var e=0==this.followDetail.is_fans?1:0;(0,a.followAuthorApi)(this.followDetail.uid,{status:e}).then((function(e){200===e.status&&(t.followDetail.is_fans=0==t.followDetail.is_fans?1:0),t.$util.Tips({title:e.message})}))}},deleteTopic:function(){var e=this;t.showModal({content:"确定要删除该话题么？",success:function(i){i.confirm?(0,a.deletePlantApi)(e.id).then((function(i){200===i.status&&(e.$util.Tips({title:i.message}),setTimeout((function(){t.redirectTo({url:"/pages/plantGrass/plant_user/index?id="+e.followDetail.uid})}),1e3))})):i.cancel}})},openMore:function(t){this.$refs.mentioned.showPopup()},close:function(){this.$refs.mentioned.closePopup(),this.$refs.bindmobile.close()}},onReachBottom:function(){this.getReplyList()},onPullDownRefresh:function(){}};e.default=d}).call(this,i("543d")["default"])},a4ce:function(t,e,i){"use strict";i.r(e);var n=i("7e30"),o=i.n(n);for(var l in n)["default"].indexOf(l)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(l);e["default"]=o.a},e01a:function(t,e,i){"use strict";(function(t,e){var n=i("4ea4");i("4c7d");n(i("66fd"));var o=n(i("0a5d"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(o.default)}).call(this,i("bc2e")["default"],i("543d")["createPage"])},f73b:function(t,e,i){"use strict";var n=i("3f0a"),o=i.n(n);o.a}},[["e01a","common/runtime","common/vendor"]]]);