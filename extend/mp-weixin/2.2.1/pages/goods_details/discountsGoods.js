(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/goods_details/discountsGoods"],{"00f9":function(t,s,i){"use strict";i.r(s);var e=i("d393"),c=i.n(e);for(var u in e)["default"].indexOf(u)<0&&function(t){i.d(s,t,(function(){return e[t]}))}(u);s["default"]=c.a},4299:function(t,s,i){},9434:function(t,s,i){"use strict";var e=i("4299"),c=i.n(e);c.a},bb8c:function(t,s,i){"use strict";i.d(s,"b",(function(){return e})),i.d(s,"c",(function(){return c})),i.d(s,"a",(function(){}));var e=function(){var t=this.$createElement;this._self._c},c=[]},ced3:function(t,s,i){"use strict";i.r(s);var e=i("bb8c"),c=i("00f9");for(var u in c)["default"].indexOf(u)<0&&function(t){i.d(s,t,(function(){return c[t]}))}(u);i("9434");var o=i("f0c5"),r=Object(o["a"])(c["default"],e["b"],e["c"],!1,null,"7b86b4b4",null,!1,e["a"],void 0);s["default"]=r.exports},d393:function(t,s,i){"use strict";(function(t){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;i("f823");var e=i("736f"),c=i("26cb"),u={components:{productWindow:function(){i.e("pages/goods_details/productWindow").then(function(){return resolve(i("301b"))}.bind(null,i)).catch(i.oe)},countDown:function(){i.e("components/countDown/index").then(function(){return resolve(i("628d"))}.bind(null,i)).catch(i.oe)}},props:{uid:{type:Number},id:{type:String||Number}},computed:(0,c.mapGetters)(["viewColor"]),data:function(){return{discountsData:[],discountsTotal:0,popup:{show:!1},attr:{cartAttr:!1,productAttr:[],productSelect:{}},productValue:[],isOpen:!1,attrValue:[],attrTxt:"",selectAttr:[],selectValue:[],proNum:0,images:[],selectCountPrice:[],selectTitle:"",seleNum:0,isFirst:!0,seleIndexn:-1,seleIndex:-1,unique:"0"}},mounted:function(){},methods:{closePopup:function(){this.$set(this.popup,"show",!1)},showPopup:function(t){this.id=t,this.$set(this.popup,"show",!0),this.getList()},initAttr:function(){var t=this;this.discountsData.map((function(s,i){t.getData(i)}))},getData:function(t){var s=this;this.discountsData[t].discountsProduct.forEach((function(i,e){s.attr.productAttr=i.product.attr,s.productValue=i.product.sku,s.DefaultSelect(t,e),s.getPrice(s.discountsData[t])}))},getList:function(){var t=this;(0,e.getDiscountsLst)({product_id:this.id}).then((function(s){s.data.list.forEach((function(s,i){s.total_price=0,s.checked_num=s.count,s.checked_save_money=0,s.discountsProduct.forEach((function(i,e){t.$set(i,"checked",!0),t.$set(i,"attr",""),t.$set(i,"unique",""),s.total_price+=parseFloat(i.product.price),s.checked_save_money+=(parseFloat(i.product.ot_price)-parseFloat(i.product.price)).toFixed(2)}))})),t.discountsTotal=s.data.count,t.discountsData=s.data.list,t.initAttr()})).catch((function(t){}))},iptCartNum:function(t){this.$set(this.attr.productSelect,"cart_num",t)},selecAttr:function(t,s){var i=this;this.proNum=t,this.seleNum=s,this.selectTitle=this.discountsData[t].discountsProduct[s].product.store_name,this.attr.productAttr=this.discountsData[t].discountsProduct[s].product.attr,this.productValue=this.discountsData[t].discountsProduct[s].product.sku,(this.isFirst||!this.isFirst&&(this.seleIndex!=t&&this.seleIndexn!=s||this.seleIndex==t&&this.seleIndexn!=s||this.seleIndex!=t&&this.seleIndexn==s)||this.unique!=this.attr.productSelect.unique)&&this.DefaultSelect(t,s),this.seleIndex=t,this.seleIndexn=s,this.isFirst=!1,this.$nextTick((function(t){i.$set(i.attr,"cartAttr",!0),i.$set(i,"isOpen",!0)}))},attrVal:function(t){this.$set(this.attr.productAttr[t.indexw],"index",this.attr.productAttr[t.indexw].attr_values[t.indexn])},ChangeAttr:function(t){var s=this.productValue[t];if(!(s&&s.stock>0))return this.$set(this.attr.productSelect,"store_name",this.discountsData[this.proNum].discountsProduct[this.seleNum].product.store_name),this.$set(this.attr.productSelect,"image",this.discountsData[this.proNum].discountsProduct[this.seleNum].product.image),this.$set(this.attr.productSelect,"price",this.discountsData[this.proNum].discountsProduct[this.seleNum].product.price),this.$set(this.attr.productSelect,"ot_price",this.discountsData[this.proNum].discountsProduct[this.seleNum].product.ot_price),this.$set(this.attr.productSelect,"product_stock",0),void this.$set(this.attr.productSelect,"unique","");this.$set(this.attr.productSelect,"image",s.image),this.$set(this.attr.productSelect,"price",s.price),this.$set(this.attr.productSelect,"stock",s.stock),this.$set(this.attr.productSelect,"product_stock",s.stock),this.$set(this.attr.productSelect,"unique",s.unique),this.$set(this,"unique",s.unique),this.$set(this.attr.productSelect,"cart_num",1),this.$set(this.discountsData[this.proNum].discountsProduct[this.seleNum],"attr",t||""),this.$set(this.discountsData[this.proNum].discountsProduct[this.seleNum]["product"],"price",s.price||0),this.$set(this.discountsData[this.proNum].discountsProduct[this.seleNum]["product"],"ot_price",s.ot_price||0),this.$set(this.discountsData[this.proNum].discountsProduct[this.seleNum],"unique",s.unique||""),this.getPrice(this.discountsData[this.proNum])},DefaultSelect:function(t,s){var i=this.attr.productAttr,e=[];for(var c in this.productValue)if(this.productValue[c].stock>0){e=this.attr.productAttr.length?c.split(","):[];break}for(var u=0;u<i.length;u++)this.$set(i[u],"index",e[u]);var o=this.productValue[e.join(",")];o&&i.length?(this.$set(this.attr.productSelect,"store_name",o.store_name),this.$set(this.attr.productSelect,"image",o.image),this.$set(this.attr.productSelect,"price",o.price),this.$set(this.attr.productSelect,"ot_price",o.ot_price),this.$set(this.attr.productSelect,"stock",o.stock),this.$set(this.attr.productSelect,"product_stock",o.stock),this.$set(this.attr.productSelect,"unique",o.unique),this.$set(this,"unique",o.unique),this.$set(this.attr.productSelect,"cart_num",1),this.$set(this.attr.productSelect,"vip_price",o.vip_price),this.$set(this.discountsData[t].discountsProduct[s],"unique",o.unique||""),this.$set(this.discountsData[t].discountsProduct[s],"attr",e.join(",")),this.$set(this.discountsData[t].discountsProduct[s]["product"],"price",o.price),this.$set(this.discountsData[t].discountsProduct[s]["product"],"ot_price",o.ot_price),this.$set(this.discountsData[t].discountsProduct[s]["product"],"ot_price",o.ot_price)):o&&!i.length?(this.$set(this.attr.productSelect,"store_name",o.store_name),this.$set(this.attr.productSelect,"image",o.image),this.$set(this.attr.productSelect,"price",o.price),this.$set(this.attr.productSelect,"ot_price",o.ot_price),this.$set(this.attr.productSelect,"stock",o.stock),this.$set(this.attr.productSelect,"product_stock",o.stock),this.$set(this.attr.productSelect,"unique",o.unique||""),this.$set(this,"unique",o.unique),this.$set(this.attr.productSelect,"cart_num",1),this.$set(this.attr.productSelect,"vip_price",o.vip_price),this.$set(this.discountsData[t].discountsProduct[s]["product"],"price",o.price),this.$set(this.discountsData[t].discountsProduct[s]["product"],"ot_price",o.ot_price),this.$set(this.discountsData[t].discountsProduct[s],"attr",""),this.$set(this.discountsData[t].discountsProduct[s],"unique",o.unique||"")):(!o&&!i.length||!o&&i.length)&&(this.$set(this.attr.productSelect,"store_name",this.discountsData[0].discountsProduct[0].product.store_name),this.$set(this.attr.productSelect,"image",this.discountsData[0].discountsProduct[0].product.image),this.$set(this.attr.productSelect,"price",this.discountsData[0].discountsProduct[0].product.price),this.$set(this.attr.productSelect,"ot_price",this.discountsData[0].discountsProduct[0].product.ot_price),this.$set(this.attr.productSelect,"product_stock",0),this.$set(this.attr.productSelect,"unique",""),this.$set(this,"unique",""))},onMyEvent:function(){this.$set(this.attr,"cartAttr",!1),this.$set(this,"isOpen",!1)},checkedChange:function(t,s){s.checked=!s.checked,s.checked?t.checked_num++:t.checked_num--,this.getPrice(t)},getPrice:function(t){var s=0,i=0;t.discountsProduct.forEach((function(t,e){t.checked&&(s+=parseFloat(t.product.ot_price)-parseFloat(t.product.price),i+=parseFloat(t.product.price))})),this.$set(t,"checked_save_money",s.toFixed(2)),this.$set(t,"total_price",i)},subData:function(s){var i=this,c={is_new:1,discount_id:this.discountsData[s].discount_id,data:[]};if(0==this.discountsData[s].type)this.selectValue=[],this.discountsData[s].discountsProduct.map((function(t){i.selectValue.push(t.discount_product_id+"")}));else{if(this.discountsData[s].checked_num<2)return this.$util.Tips({title:"请先选择套餐商品"});this.selectValue=[],this.discountsData[s].discountsProduct.map((function(t){t.checked&&i.selectValue.push(t.discount_product_id+"")}))}for(var u=0;u<this.discountsData[s].discountsProduct.length;u++)for(var o=0;o<this.selectValue.length;o++)this.discountsData[s].discountsProduct[u].discount_product_id==this.selectValue[o]&&c.data.push({cart_num:1,product_attr_unique:this.discountsData[s].discountsProduct[u].unique,product_id:this.discountsData[s].discountsProduct[u].product_id});(0,e.discountsCartAdd)(c).then((function(s){t.navigateTo({url:"/pages/users/order_confirm/index?cartId="+s.data.cart_id.join(",")})})).catch((function(t){return i.selectValue=[],i.$util.Tips({title:t})}))},goOrder:function(){this.$set(this,"isOpen",!1),this.$set(this.attr,"cartAttr",!1)}}};s.default=u}).call(this,i("543d")["default"])}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'pages/goods_details/discountsGoods-create-component',
    {
        'pages/goods_details/discountsGoods-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("ced3"))
        })
    },
    [['pages/goods_details/discountsGoods-create-component']]
]);
